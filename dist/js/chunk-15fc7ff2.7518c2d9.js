(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15fc7ff2"],{1683:function(e,t,n){},"704a":function(e,t,n){"use strict";n("1683")},"7eb8":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.show?n("div",{staticClass:"examTips"},[n("a-result",{staticStyle:{background:"#fff","border-radius":"15px"},attrs:{status:"success",title:"提交成功","sub-title":"— 感谢您的参与 —"}})],1):n("div",{staticStyle:{padding:"20px"}},[n("h2",{staticClass:"title"},[e._v(e._s(e.form.questionnaire_title))]),e.form.questionnaire_describe?n("p",[e._v(e._s(e.form.questionnaire_describe))]):e._e(),n("a-divider",{attrs:{dashed:""}}),e._l(e.form.questionnaire_question,(function(t,i){return n("div",{key:t.id,staticClass:"content"},[n("a-row",[n("a-col",{attrs:{span:20}},[n("p",[n("span",{class:Number(t.must_answer)?"star":"",staticStyle:{color:"#1A8CFE","font-weight":"bold"}},[e._v(e._s(i+1)+"、")]),4==t.question_type?n("span",[n("CompletionComponent",{attrs:{content:t.stem,subjectId:t.id}})],1):n("span",{domProps:{innerHTML:e._s(t.stem)}})]),1==t.question_type?n("a-radio-group",{staticStyle:{width:"100%"},on:{change:function(n){return e.onChangeSingleChoice(n,t)}}},e._l(t.questionnaire_question_option,(function(t){return n("a-radio",{key:t.id||t.key,style:e.radioStyle,attrs:{value:t.sort}},[n("span",{domProps:{innerHTML:e._s(t.content)}}),e._v(" "),"1"==t.is_fill?n("a-input",{attrs:{placeholder:"请输入内容"},model:{value:t.answer_content,callback:function(n){e.$set(t,"answer_content",n)},expression:"itemc.answer_content"}}):e._e()],1)})),1):e._e(),2==t.question_type?n("a-checkbox-group",{staticStyle:{width:"100%"},on:{change:function(n){return e.onChangeMultipleChoice(n,t)}}},e._l(t.questionnaire_question_option,(function(t){return n("a-checkbox",{key:t.id||t.key,style:e.radioStyle,attrs:{value:t.sort}},[n("span",{domProps:{innerHTML:e._s(t.content)}}),e._v(" "),"1"==t.is_fill?n("a-input",{attrs:{placeholder:"请输入内容"},model:{value:t.answer_content,callback:function(n){e.$set(t,"answer_content",n)},expression:"itemc.answer_content"}}):e._e()],1)})),1):e._e(),3==t.question_type?n("a-radio-group",{staticStyle:{display:"block","margin-top":"15px"},attrs:{"button-style":"solid"},on:{change:function(n){return e.onChangeSingleChoice(n,t)}}},[n("a-radio-button",{attrs:{value:"true"}},[e._v("正确")]),n("a-radio-button",{attrs:{value:"false"}},[e._v("错误")])],1):e._e(),5==t.question_type?n("span",[n("a-textarea",{staticStyle:{margin:"15px 0"},attrs:{placeholder:"",rows:4},model:{value:t.answer,callback:function(n){e.$set(t,"answer",n)},expression:"item.answer"}})],1):e._e()],1)],1)],1)})),n("div",[n("a-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary",block:"",size:"large"},on:{click:e.submit}},[n("a-icon",{attrs:{type:"folder-open"}}),e._v(" 提交")],1)],1)],2)])},s=[],o=(n("a9e3"),n("159b"),n("d8ad")),r=n("56cd3"),a=n("15b6"),u={components:{CompletionComponent:r["default"]},data:function(){return{radioStyle:{display:"block",height:"40px",lineHeight:"40px"},form:{},submitInfor:{questionnaire_id:"",answer_time:0,questionnaire_result:[]},startTime:0,completion_result:[],show:!1}},created:function(){this.show=!1,this.submitInfor.questionnaire_id=Number(this.$route.params.id),this.getQuestionnaire(this.submitInfor.questionnaire_id)},mounted:function(){o["a"].$on("result",this.onChangeCompletionResult)},methods:{submit:function(){var e=this;if(!this.verification())return this.$message.error("有必填项未填写！"),!1;var t=parseInt(((new Date).getTime()-this.startTime)/1e3/60%60);this.submitInfor.answer_time=t,this.formatSubmitData(),Object(a["i"])(this.submitInfor).then((function(t){t.success?(e.show=!0,e.$message.success("提交成功！")):e.$message.error("提交失败："+t.message)}))},verification:function(){for(var e=!0,t=0;t<this.form.questionnaire_question.length;t++){var n=this.form.questionnaire_question[t];if(1===n.must_answer&&!n.answer&&4!==n.question_type){e=!1;break}}return e},getQuestionnaire:function(e){var t=this;Object(a["d"])({id:e}).then((function(e){e.success?(t.form=e.data,t.form.questionnaire_question.forEach((function(e){1!==e.question_type&&2!==e.question_type||e.questionnaire_question_option.forEach((function(e){"1"==e.is_fill&&(e["answer_content"]="")})),4!==e.question_type&&(e["answer"]="")})),t.startTime=(new Date).getTime()):t.$message.error("获取问卷失败："+e.message)}))},onChangeSingleChoice:function(e,t){t.answer=e.target.value},onChangeMultipleChoice:function(e,t){t.answer=e},onChangeCompletionResult:function(e){var t=this;this.completion_result.length?this.completion_result.forEach((function(n){n.id===e.id?n.questionnaire_result_detailed=e.questionnaire_result_detailed:t.completion_result.push(e)})):this.completion_result.push(e)},formatSubmitData:function(){var e=this;this.submitInfor.questionnaire_result=[],this.form.questionnaire_question.forEach((function(t){var n={id:"",questionnaire_result_detailed:[]};n.id=t.id,n.questionnaire_result_detailed=[],1===t.question_type?(t.questionnaire_question_option.forEach((function(e){e.sort===t.answer&&"1"==e.is_fill?n.questionnaire_result_detailed.push({checked_num:t.answer+"",answer_content:e.answer_content}):e.sort===t.answer&&n.questionnaire_result_detailed.push({checked_num:t.answer+"",answer_content:""})})),e.submitInfor.questionnaire_result.push(n)):2===t.question_type?t.answer.length&&(t.answer.forEach((function(e){t.questionnaire_question_option.forEach((function(t){t.sort===e&&"1"==t.is_fill?n.questionnaire_result_detailed.push({checked_num:e+"",answer_content:t.answer_content}):t.sort===e&&n.questionnaire_result_detailed.push({checked_num:e+"",answer_content:""})}))})),e.submitInfor.questionnaire_result.push(n)):3===t.question_type?(n.questionnaire_result_detailed.push({checked_num:t.answer+"",answer_content:""}),e.submitInfor.questionnaire_result.push(n)):5===t.question_type&&(n.questionnaire_result_detailed.push({checked_num:"1",answer_content:t.answer+""}),e.submitInfor.questionnaire_result.push(n))})),this.completion_result.length&&this.completion_result.forEach((function(t){e.submitInfor.questionnaire_result.push(t)}))}},beforeDestroy:function(){o["a"].$off("result")}},c=u,l=(n("704a"),n("0c7c")),_=Object(l["a"])(c,i,s,!1,null,"4b6e08de",null);t["default"]=_.exports}}]);