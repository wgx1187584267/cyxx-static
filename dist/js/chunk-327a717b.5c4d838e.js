(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-327a717b"],{"43b3":function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"i",(function(){return o})),a.d(t,"h",(function(){return r})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return m}));var n=a("b775");function i(e){return Object(n["b"])({url:"/dataBase/columnInfoList",method:"get",params:e})}function s(){return Object(n["b"])({url:"/dataBase/tableInfoList",method:"get"})}function l(e){return Object(n["b"])({url:"/table/add",method:"post",data:e})}function o(e){return Object(n["b"])({url:"/table/edit",method:"post",data:e})}function r(e){return Object(n["b"])({url:"/table/delete",method:"post",data:e})}function c(e){return Object(n["b"])({url:"/column/add",method:"post",data:e})}function d(e){return Object(n["b"])({url:"/column/edit",method:"post",data:e})}function u(e){return Object(n["b"])({url:"/column/delete",method:"post",data:e})}function m(e){return Object(n["b"])({url:"/table/createEntity",method:"post",data:e})}},"4e9f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"新增数据表",width:1200,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-divider",{attrs:{orientation:"left"}},[e._v("数据表信息")]),a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"表名",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入表名！"}]}],expression:"['name',{rules: [{required: true, message: '请输入表名！'}]}]"}],attrs:{placeholder:"请输入表名"}})],1),a("a-form-item",{attrs:{label:"描述",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:"请输入描述！"}]}],expression:"['description',{rules: [{required: true, message: '请输入描述！'}]}]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入描述"}})],1)],1)],1),a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-divider",{attrs:{orientation:"left"}},[e._v("数据列信息")]),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:24,sm:24}},[a("a-table",{attrs:{size:"middle",columns:e.columnShowColumns,dataSource:e.columnInfo,pagination:!1,loading:!1},scopedSlots:e._u([{key:"dbColumnName",fn:function(t,n){return[a("a-input",{staticStyle:{width:"120px"},model:{value:n.dbColumnName,callback:function(t){e.$set(n,"dbColumnName",t)},expression:"record.dbColumnName"}})]}},{key:"columnDescription",fn:function(t,n){return[a("a-input",{staticStyle:{width:"120px"},model:{value:n.columnDescription,callback:function(t){e.$set(n,"columnDescription",t)},expression:"record.columnDescription"}})]}},{key:"isPrimarykey",fn:function(t,n){return[a("a-select",{key:"isPrimarykey",staticStyle:{width:"120px"},attrs:{placeholder:"请选择","has-feedback":""},on:{change:function(t){return e.primarykeyHandleChange(t,n.key)}},model:{value:n.isPrimarykey,callback:function(t){e.$set(n,"isPrimarykey",t)},expression:"record.isPrimarykey"}},e._l(e.selectData,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.text)+" ")])})),1)]}},{key:"isIdentity",fn:function(t,n){return[a("a-select",{key:"isIdentity",staticStyle:{width:"120px"},attrs:{placeholder:"请选择","has-feedback":"",disabled:0==n.isPrimarykey},model:{value:n.isIdentity,callback:function(t){e.$set(n,"isIdentity",t)},expression:"record.isIdentity"}},e._l(e.selectData,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.text)+" ")])})),1)]}},{key:"isNullable",fn:function(t,n){return[a("a-select",{key:"isNullable",staticStyle:{width:"120px"},attrs:{placeholder:"请选择","has-feedback":"",disabled:1==n.isPrimarykey},model:{value:n.isNullable,callback:function(t){e.$set(n,"isNullable",t)},expression:"record.isNullable"}},e._l(e.selectData,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.text)+" ")])})),1)]}},{key:"dataType",fn:function(t,n){return[a("a-select",{key:"dataType",staticStyle:{width:"120px"},attrs:{placeholder:"请选择","has-feedback":""},on:{change:function(t){return e.dataTypeHandleChange(t,n.key)}},model:{value:n.dataType,callback:function(t){e.$set(n,"dataType",t)},expression:"record.dataType"}},e._l(e.dataTypeSelectData,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.value)+" ")])})),1)]}},{key:"length",fn:function(t,n){return[a("a-input-number",{attrs:{disabled:!n.hasLength},model:{value:n.length,callback:function(t){e.$set(n,"length",t)},expression:"record.length"}})]}},{key:"decimalDigits",fn:function(t,n){return[a("a-input-number",{attrs:{disabled:!n.hasDecimalDigits},model:{value:n.decimalDigits,callback:function(t){e.$set(n,"decimalDigits",t)},expression:"record.decimalDigits"}})]}},{key:"operation",fn:function(t,n){return[a("a",{on:{click:function(t){return e.remove(n.key)}}},[e._v("删除")])]}}])})],1)],1),a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{span:6}},[a("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.addPrimaryColumn}},[e._v("新增主键字段")])],1),a("a-col",{attrs:{span:6}},[a("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.addColumn}},[e._v("新增普通字段")])],1),a("a-col",{attrs:{span:6}},[a("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.addTenantColumn}},[e._v("新增租户字段")])],1),a("a-col",{attrs:{span:6}},[a("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.addBaseColumn}},[e._v("新增基础字段")])],1)],1)],1)],1)},i=[],s=a("d0ff"),l=(a("7db0"),a("4de4"),a("b0c0"),a("d3b7"),a("43b3")),o={data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),selectData:[{text:"是",value:1},{text:"否",value:0}],dataTypeSelectData:[{value:"text",hasLength:!1,hasDecimalDigits:!1},{value:"varchar",hasLength:!0,hasDecimalDigits:!1},{value:"nvarchar",hasLength:!0,hasDecimalDigits:!1},{value:"char",hasLength:!0,hasDecimalDigits:!1},{value:"nchar",hasLength:!0,hasDecimalDigits:!1},{value:"timestamp",hasLength:!1,hasDecimalDigits:!1},{value:"int",hasLength:!1,hasDecimalDigits:!1},{value:"smallint",hasLength:!1,hasDecimalDigits:!1},{value:"tinyint",hasLength:!1,hasDecimalDigits:!1},{value:"bigint",hasLength:!1,hasDecimalDigits:!1},{value:"bit",hasLength:!1,hasDecimalDigits:!1},{value:"decimal",hasLength:!0,hasDecimalDigits:!0},{value:"datetime",hasLength:!1,hasDecimalDigits:!1}],columnInfo:[],columnShowColumns:[{title:"字段名",dataIndex:"dbColumnName",scopedSlots:{customRender:"dbColumnName"}},{title:"描述",dataIndex:"columnDescription",scopedSlots:{customRender:"columnDescription"}},{title:"主键",dataIndex:"isPrimarykey",scopedSlots:{customRender:"isPrimarykey"}},{title:"自增",dataIndex:"isIdentity",scopedSlots:{customRender:"isIdentity"}},{title:"类型",dataIndex:"dataType",scopedSlots:{customRender:"dataType"}},{title:"可空",dataIndex:"isNullable",scopedSlots:{customRender:"isNullable"}},{title:"长度",dataIndex:"length",scopedSlots:{customRender:"length"}},{title:"保留几位小数",dataIndex:"decimalDigits",scopedSlots:{customRender:"decimalDigits"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}]}},methods:{dataTypeHandleChange:function(e,t){var a=Object(s["a"])(this.columnInfo),n=a.find((function(e){return t===e.key}));if(n){var i=this.dataTypeSelectData.find((function(t){return t.value==e}));i&&(n["hasLength"]=i.hasLength,n["hasDecimalDigits"]=i.hasDecimalDigits,n["hasLength"]||(n["length"]=0),n["hasDecimalDigits"]||(n["decimalDigits"]=0),this.columnInfo=a)}},primarykeyHandleChange:function(e,t){var a=Object(s["a"])(this.columnInfo),n=a.find((function(e){return t===e.key}));n&&(1==e?n["isNullable"]=0:n["isIdentity"]=0,this.columnInfo=a)},remove:function(e){var t=this.columnInfo.filter((function(t){return t.key!==e}));this.columnInfo=t},addColumn:function(){var e=this.columnInfo.length;this.columnInfo.push({key:0===e?1:parseInt(this.columnInfo[e-1].key)+1,columnDescription:"",dataType:"",dbColumnName:"",decimalDigits:0,isIdentity:0,isNullable:1,isPrimarykey:0,length:0})},addTenantColumn:function(){var e=this.columnInfo.length;this.columnInfo.push({key:0===e?1:parseInt(this.columnInfo[e-1].key)+1,columnDescription:"租户Id",dataType:"bigint",dbColumnName:"TenantId",decimalDigits:0,isIdentity:0,isNullable:1,isPrimarykey:0,length:0})},addPrimaryColumn:function(){var e=this.columnInfo.length;this.columnInfo.push({key:0===e?1:parseInt(this.columnInfo[e-1].key)+1,columnDescription:"主键Id",dataType:"bigint",dbColumnName:"Id",decimalDigits:0,isIdentity:0,isNullable:0,isPrimarykey:1,length:0})},addBaseColumn:function(){var e=this,t=[{dataType:"datetime",name:"CreatedTime",desc:"创建时间"},{dataType:"datetime",name:"UpdatedTime",desc:"更新时间"},{dataType:"bigint",name:"CreatedUserId",desc:"创建者Id"},{dataType:"nvarchar",name:"CreatedUserName",desc:"创建者名称",length:20},{dataType:"bigint",name:"UpdatedUserId",desc:"修改者Id"},{dataType:"nvarchar",name:"UpdatedUserName",desc:"修改者名称",length:20},{dataType:"bit",name:"IsDeleted",desc:"软删除",isNullable:0}];t.forEach((function(t){var a=e.columnInfo.length,n=0===a?1:parseInt(e.columnInfo[a-1].key)+1;e.columnInfo.push({key:n,columnDescription:t.desc,dataType:t.dataType,dbColumnName:t.name,decimalDigits:0,isIdentity:0,isNullable:0===t.isNullable?0:1,isPrimarykey:0,length:t.length||0})}))},add:function(e){this.visible=!0},handleSubmit:function(){for(var e=this,t="",a=0;a<this.columnInfo.length;a++){var n=this.columnInfo[a];if(("varchar"===n.dataType||"nvarchar"===n.dataType)&&n.length<=0){t="字段类型为varchar或者nvarchar时，长度不能小于0";break}}if(t)return this.$message.warning(t),!1;var i=this.form.validateFields;this.confirmLoading=!0,i((function(t,a){t?e.confirmLoading=!1:(a["dbColumnInfoList"]=e.columnInfo,Object(l["g"])(a).then((function(t){t.success?(e.$message.success("新增成功"),e.confirmLoading=!1,e.$emit("ok",a),e.handleCancel()):e.$message.error("新增失败")})).finally((function(t){e.confirmLoading=!1})))}))},handleCancel:function(){this.form.resetFields(),this.columnInfo=[],this.visible=!1}}},r=o,c=a("0c7c"),d=Object(c["a"])(r,n,i,!1,null,null,null);t["default"]=d.exports}}]);