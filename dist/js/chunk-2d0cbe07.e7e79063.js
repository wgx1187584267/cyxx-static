(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cbe07"],{"4c13":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-alert",{attrs:{message:"该功能只适配了SqlServer、MySQL数据库,其他数据库请自行研究",banner:"",closable:"",type:"info","how-icon":""}}),a("a-row",{attrs:{gutter:24}},[a("a-col",{staticStyle:{padding:"0 0 0 0"},attrs:{md:9,sm:24}},[a("a-card",{attrs:{bordered:!1}},[a("s-table",{ref:"table",attrs:{columns:e.tableShowColumns,data:e.tableData,alert:!0,rowKey:function(e){return e.name},showPagination:!1,customRow:e.rowClick},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[e.hasPerm("table:edit")?a("a",{on:{click:function(t){return t.stopPropagation(),e.$refs.editTableForm.edit(r)}}},[e._v("编辑")]):e._e(),e.hasPerm("table:delete")?a("a-divider",{attrs:{type:"vertical"}}):e._e(),e.hasPerm("table:delete")?a("a-popconfirm",{attrs:{placement:"topRight",title:"确认删除？"},on:{confirm:function(){return e.tableDelete(r)}}},[a("a",[e._v("删除")])]):e._e(),e.hasPerm("table:createEntity")?a("a-divider",{attrs:{type:"vertical"}}):e._e(),e.hasPerm("table:createEntity")?a("a",{on:{click:function(t){return t.stopPropagation(),e.showModal(r.name)}}},[e._v("生成实体")]):e._e()],1)}}])},[e.hasPerm("table:add")?a("template",{slot:"operator"},[e.hasPerm("table:add")?a("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:function(t){return e.$refs.addTableForm.add()}}},[e._v("新增数据表 ")]):e._e()],1):e._e()],2),a("add-table-form",{ref:"addTableForm",on:{ok:e.tableHandleOk}}),a("edit-table-form",{ref:"editTableForm",on:{ok:e.tableHandleOk}})],1)],1),a("a-col",{attrs:{md:15,sm:24}},[a("a-card",{attrs:{bordered:!1}},[a("s-table",{ref:"columnTable",attrs:{columns:e.columnShowColumns,data:e.columnInfo,alert:!0,rowKey:function(e){return e.dbColumnName},showPagination:!1},scopedSlots:e._u([{key:"isPrimarykey",fn:function(t,r){return[a("span",[e._v(e._s(r.isPrimarykey?"是":"否"))])]}},{key:"isIdentity",fn:function(t,r){return[a("span",[e._v(e._s(r.isIdentity?"是":"否"))])]}},{key:"isNullable",fn:function(t,r){return[a("span",[e._v(e._s(r.isNullable?"是":"否"))])]}},{key:"action",fn:function(t,r){return a("span",{},[e.hasPerm("column:edit")?a("a",{on:{click:function(t){return e.$refs.editColumnForm.edit(r)}}},[e._v("编辑")]):e._e(),e.hasPerm("column:delete")?a("a-divider",{attrs:{type:"vertical"}}):e._e(),e.hasPerm("column:delete")?a("a-popconfirm",{attrs:{placement:"topRight",title:"确认删除？"},on:{confirm:function(){return e.columnDelete(r)}}},[a("a",[e._v("删除")])]):e._e()],1)}}])},[e.hasPerm("table:add")&&e.queryParam.tableName?a("template",{slot:"operator"},[e.hasPerm("column:add")?a("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:function(t){return e.$refs.addColumnForm.add(e.queryParam.tableName)}}},[e._v("新增("+e._s(e.queryParam.tableName)+")数据列 ")]):e._e()],1):e._e()],2),a("add-column-form",{ref:"addColumnForm",on:{ok:e.columnHandleOk}}),a("edit-column-form",{ref:"editColumnForm",on:{ok:e.columnHandleOk}})],1)],1),a("a-modal",{attrs:{visible:e.createEntityVisible,title:"配置实体名",okText:"确认","cancel-text":"取消"},on:{cancel:e.modalCancel,ok:e.createEntity}},[a("a-form",{attrs:{form:e.createEntityForm}},[a("span",{staticStyle:{color:"red"}},[e._v("会覆盖同一路径下的同名文件，慎重。生成完需要重新编译！")]),a("br"),a("span",{staticStyle:{color:"red"}},[e._v("基类不知道什么意思的去看项目里面这四个类！")]),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["tableName"],expression:"['tableName']"}]})],1),a("a-form-item",{attrs:{label:"实体名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["entityName",{rules:[{required:!0,message:"请输入实体名称!"}]}],expression:"['entityName', { rules: [{ required: true, message: '请输入实体名称!' }] }]"}],attrs:{placeholder:"请输入实体名称",width:"100%"}})],1),a("a-form-item",{attrs:{label:"基类"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["baseClassName"],expression:"['baseClassName']"}],key:"baseClassName",staticStyle:{width:"100%"},attrs:{placeholder:"请选择","has-feedback":""}},e._l(e.baseClassOptions,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t}},[e._v(e._s(t)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"存放位置"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["position",{rules:[{required:!0,message:"请选择存放位置!"}]}],expression:"['position', { rules: [{ required: true, message: '请选择存放位置!' }] }]"}],key:"position",staticStyle:{width:"100%"},attrs:{placeholder:"请选择","has-feedback":""}},e._l(e.positionOption,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t}},[e._v(e._s(t)+" ")])})),1)],1)],1)],1)],1)],1)},n=[],o=(a("b0c0"),a("2af9")),s=a("43b3"),i=a("4e9f"),l=a("0d70"),c=a("bd73"),m=a("6a58"),d={components:{STable:o["r"],addTableForm:i["default"],editTableForm:l["default"],editColumnForm:m["default"],addColumnForm:c["default"]},data:function(){var e=this;return{createEntityForm:this.$form.createForm(this),createEntityParams:{entityName:"",tableName:"",baseClassName:"",position:""},baseClassOptions:["PrimaryKeyEntity","AutoIncrementEntity","DEntityBase","DBEntityTenant"],positionOption:["Magic.Application","Magic.Core"],createEntityVisible:!1,tableLoading:!1,columnLoading:!1,queryParam:{},tableShowColumns:[{title:"表名",dataIndex:"name"},{title:"描述",dataIndex:"description"}],columnShowColumns:[{title:"字段名",dataIndex:"dbColumnName"},{title:"描述",dataIndex:"columnDescription"},{title:"主键",dataIndex:"isPrimarykey",scopedSlots:{customRender:"isPrimarykey"}},{title:"自增",dataIndex:"isIdentity",scopedSlots:{customRender:"isIdentity"}},{title:"可空",dataIndex:"isNullable",scopedSlots:{customRender:"isNullable"}},{title:"类型",dataIndex:"dataType"}],columnInfo:function(t){return Object(s["e"])(e.queryParam).then((function(e){return e.data}))},tableData:function(e){return Object(s["f"])(Object.assign(e)).then((function(e){return e.data}))},rowClick:function(t,a){return{on:{click:function(){e.queryParam={tableName:t.name},e.$refs.columnTable.refresh(!0)}}}}}},created:function(){(this.hasPerm("table:edit")||this.hasPerm("table:delete"))&&this.tableShowColumns.push({title:"操作",width:"200px",dataIndex:"action",scopedSlots:{customRender:"action"}}),(this.hasPerm("column:edit")||this.hasPerm("column:delete"))&&this.columnShowColumns.push({title:"操作",width:"200px",dataIndex:"action",scopedSlots:{customRender:"action"}})},methods:{showModal:function(e){var t=this;this.createEntityVisible=!0,setTimeout((function(){t.createEntityForm.setFieldsValue({tableName:e})}),100)},createEntity:function(){var e=this;this.createEntityForm.validateFields((function(t,a){t||Object(s["d"])(a).then((function(t){t.success?(e.$message.success("生成成功"),e.modalCancel()):e.$message.error("生成失败")}))}))},modalCancel:function(){this.createEntityVisible=!1,this.createEntityForm.resetFields()},tableHandleOk:function(){this.$refs.table.refresh()},columnHandleOk:function(){this.$refs.columnTable.refresh()},tableDelete:function(e){var t=this;Object(s["h"])(e).then((function(e){e.success?(t.$message.success("删除成功"),t.$refs.table.refresh(),t.$refs.columnTable.refresh()):t.$message.error("删除失败")}))},columnDelete:function(e){var t=this;Object(s["b"])(e).then((function(e){e.success?(t.$message.success("删除成功"),t.$refs.columnTable.refresh()):t.$message.error("删除失败")}))}}},u=d,f=a("0c7c"),b=Object(f["a"])(u,r,n,!1,null,null,null);t["default"]=b.exports}}]);