(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47d6b950"],{1271:function(e,t,i){"use strict";i.d(t,"h",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return o})),i.d(t,"g",(function(){return l})),i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return c})),i.d(t,"i",(function(){return m})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return h}));var s=i("b775");function r(e){return Object(s["b"])({url:"/SportsEvaluationRecord/GetGradeProject",method:"get",params:e})}function a(e){return Object(s["b"])({url:"/SportsEvaluationRecord/Create",method:"post",data:e})}function o(e){return Object(s["b"])({url:"/SportsEvaluationRecord/Del",method:"post",data:e})}function l(e){return Object(s["b"])({url:"/SportsEvaluationRecord/Get",method:"get",params:e})}function n(e){return Object(s["b"])({url:"/SportsEvaluationRecord/Detail",method:"get",params:e})}function c(e){return Object(s["b"])({url:"/SportsEvaluationRecord/DownloadTemplate",method:"post",data:e,responseType:"blob"})}function m(e,t){return Object(s["b"])({url:"/SportsEvaluationRecord/Import",method:"post",data:e,onUploadProgress:function(e){var i=e.loaded/e.total*100|0;t&&t(i)}})}function u(e){return Object(s["b"])({url:"/SportsEvaluationRecord/Export",method:"post",data:e,responseType:"blob"})}function h(e){return Object(s["b"])({url:"/SportsEvaluationRecord/ExportFailed",method:"post",data:e,responseType:"blob"})}},a797:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:600,visible:e.visible},on:{cancel:e.handleCancel,ok:e.handleSubmit}},[i("a-form-model",{ref:"ruleForm",attrs:{model:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,rules:e.rules}},[e.visible?i("a-tabs",{model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[i("a-tab-pane",{key:"1",attrs:{tab:"新增"}},[e.isBMI&&"1"==e.activeKey||e.isEye&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"学期类型",prop:"semester_type"}},[i("a-select",{attrs:{"allow-clear":"",placeholder:"请选择学期类型"},model:{value:e.form.semester_type,callback:function(t){e.$set(e.form,"semester_type",t)},expression:"form.semester_type"}},e._l(e.semesterType,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),e.isBMI&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"身高(cm)",prop:"high"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入值"},model:{value:e.form.high,callback:function(t){e.$set(e.form,"high",t)},expression:"form.high"}})],1):e._e(),e.isBMI&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"体重(kg)",prop:"weight"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入值"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}})],1):e._e(),e.isBMI&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"BMI分值",prop:"bmi"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入值",min:0,max:100},model:{value:e.form.bmi,callback:function(t){e.$set(e.form,"bmi",t)},expression:"form.bmi"}})],1):e._e(),e.isBMI&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"BMI等级",prop:"bmi_level"}},[i("a-select",{attrs:{"allow-clear":"",placeholder:"请选择等级"},model:{value:e.form.bmi_level,callback:function(t){e.$set(e.form,"bmi_level",t)},expression:"form.bmi_level"}},e._l(e.bmiLevel,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),e.isEye&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"左眼视力",prop:"value"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入值"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1):e._e(),e.isEye&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"左眼等级",prop:"value_level"}},[i("a-select",{attrs:{"allow-clear":"",placeholder:"请选择等级"},model:{value:e.form.value_level,callback:function(t){e.$set(e.form,"value_level",t)},expression:"form.value_level"}},e._l(e.standardsRank,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),e.isEye&&"1"==e.activeKey?i("a-form-model-item",{attrs:{prop:"value2"}},[i("template",{slot:"label"},[i("span",[e._v("右眼视力")])]),i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入值"},model:{value:e.form.value2,callback:function(t){e.$set(e.form,"value2",t)},expression:"form.value2"}})],2):e._e(),e.isEye&&"1"==e.activeKey?i("a-form-model-item",{attrs:{prop:"value2_level"}},[i("template",{slot:"label"},[i("span",[e._v("右眼等级")])]),i("a-select",{attrs:{"allow-clear":"",placeholder:"请选择等级"},model:{value:e.form.value2_level,callback:function(t){e.$set(e.form,"value2_level",t)},expression:"form.value2_level"}},e._l(e.standardsRank,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],2):e._e(),e.isSkill&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"操作类型",prop:"operation_type"}},[i("a-radio-group",{model:{value:e.form.operation_type,callback:function(t){e.$set(e.form,"operation_type",t)},expression:"form.operation_type"}},e._l(e.operationType,(function(t,s){return i("a-radio",{key:s,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),(e.isAttendance||e.isOther||e.isBasic||e.isSkill)&&"1"==e.activeKey?i("a-form-model-item",{attrs:{prop:"score"}},[i("template",{slot:"label"},[i("span",[e._v("分值设置")])]),i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入分值设置",min:0,max:100},model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}})],2):e._e(),"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"是否计入核算",prop:"yes_or_no"}},[i("a-radio-group",{model:{value:e.form.yes_or_no,callback:function(t){e.$set(e.form,"yes_or_no",t)},expression:"form.yes_or_no"}},e._l(e.yesOrNoData,(function(t,s){return i("a-radio",{key:s,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),e.isRequire&&"jump"==e.sportType&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"立定跳远成绩(cm)",prop:"jump"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入立定跳远成绩(cm)"},model:{value:e.form.jump,callback:function(t){e.$set(e.form,"jump",t)},expression:"form.jump"}})],1):e._e(),e.isRequire&&"skipping"==e.sportType&&"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"一分钟跳绳成绩(个)",prop:"skipping"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入一分钟跳绳成绩(个)"},model:{value:e.form.skipping,callback:function(t){e.$set(e.form,"skipping",t)},expression:"form.skipping"}})],1):e._e(),"1"==e.activeKey?i("a-form-model-item",{attrs:{label:"备注"}},[i("a-textarea",{attrs:{placeholder:"请输入备注",allowClear:!0,"auto-size":{minRows:2}},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1):e._e()],1),!e.isEdit||e.isHeight||e.isWeight||e.isBMI||e.isEye||e.isRequire||e.isAttendance?e._e():i("a-tab-pane",{key:"2",attrs:{tab:"变更"}},["2"==e.activeKey?i("a-form-model-item",{attrs:{label:"当前分值",prop:"beforeScore"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入当前分值",disabled:!0},model:{value:e.form.beforeScore,callback:function(t){e.$set(e.form,"beforeScore",t)},expression:"form.beforeScore"}})],1):e._e(),"2"==e.activeKey?i("a-form-model-item",{attrs:{label:"变更后分值",prop:"afterScore"}},[i("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入变更后分值",min:0,max:100},model:{value:e.form.afterScore,callback:function(t){e.$set(e.form,"afterScore",t)},expression:"form.afterScore"}})],1):e._e(),"2"==e.activeKey?i("a-form-model-item",{attrs:{label:"是否计入核算",prop:"yes_or_no"}},[i("a-radio-group",{model:{value:e.form.yes_or_no,callback:function(t){e.$set(e.form,"yes_or_no",t)},expression:"form.yes_or_no"}},e._l(e.yesOrNoData,(function(t,s){return i("a-radio",{key:s,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),"2"==e.activeKey?i("a-form-model-item",{attrs:{label:"备注"}},[i("a-textarea",{attrs:{placeholder:"请输入备注",allowClear:!0,"auto-size":{minRows:2}},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1):e._e()],1)],1):e._e()],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("a-button",{key:"back",on:{click:e.handleCancel}},[e._v(" 取消 ")]),i("a-button",{key:"submit",attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("确定 ")])],1)],1)},r=[],a=(i("a15b"),i("1271")),o=i("d0fff"),l={data:function(){return{title:"评价",labelCol:{span:6},wrapperCol:{span:14},visible:!1,loading:!1,fieldNames:{label:"name",value:"id",children:"children"},rules:{value:[{required:!0,message:"请输入值",trigger:"blur"}],value_level:[{required:!0,message:"请选择等级",trigger:"change"}],value2:[{required:!0,message:"请输入值",trigger:"blur"}],value2_level:[{required:!0,message:"请选择等级",trigger:"change"}],operation_type:[{required:!0,message:"请选择操作类型",trigger:"change"}],score:[{required:!0,message:"请输入分值设置",trigger:"blur"}],yes_or_no:[{required:!0,message:"请选择是否计入核算",trigger:"change"}],jump:[{required:!0,message:"请输入立定跳远成绩(cm)",trigger:"blur"}],skipping:[{required:!0,message:"请输入一分钟跳绳成绩(个)",trigger:"blur"}],beforeScore:[{required:!0,message:"请输入当前分值",trigger:"blur"}],afterScore:[{required:!0,message:"请输入变更后分值",trigger:"blur"}],semester_type:[{required:!0,message:"请选择学期类型",trigger:"change"}],high:[{required:!0,message:"请输入身高",trigger:"blur"}],weight:[{required:!0,message:"请输入体重",trigger:"blur"}],bmi:[{required:!0,message:"请输入BMI分值",trigger:"blur"}],bmi_level:[{required:!0,message:"请选择BMI等级",trigger:"change"}]},form:{evaluation_project_id:null},isHeight:!1,isWeight:!1,isBMI:!1,isEye:!1,isAttendance:!1,isBasic:!1,isSkill:!1,isRequire:!1,isOther:!1,yesOrNoData:[],operationType:[],standardsRank:[],bmiLevel:[],semesterType:[],yearTree:[],gradeId:null,sportType:null,activeKey:"1",isEdit:!1,anchorPoint:""}},methods:{setting:function(e,t,i,s,r,a,o,l,n,c,m){this.title=r+"评价",this.visible=!0,this.loading=!1,this.form=Object.assign({},this.$options.data().form),"solo"==e?(this.isEdit=!0,this.anchorPoint="itemId"+i,this.$set(this.form,"beforeScore",t),this.$set(this.form,"record_id",m)):"more"==e&&(this.isEdit=!1),this.activeKey="1","H"==a?(this.isHeight=!0,this.isWeight=!1,this.isBMI=!1,this.isEye=!1,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!1,this.isRequire=!1,this.isOther=!1):"W"==a?(this.isHeight=!1,this.isWeight=!0,this.isBMI=!1,this.isEye=!1,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!1,this.isRequire=!1,this.isOther=!1):"B"==a?(this.isHeight=!1,this.isWeight=!1,this.isBMI=!0,this.isEye=!1,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!1,this.isRequire=!1,this.isOther=!1):"V"==a?(this.isHeight=!1,this.isWeight=!1,this.isBMI=!1,this.isEye=!0,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!1,this.isRequire=!1,this.isOther=!1):"1"==a?(this.isHeight=!1,this.isWeight=!1,this.isBMI=!1,this.isEye=!1,this.isAttendance=!0,this.$set(this.form,"operation_type","2"),this.isBasic=!1,this.isSkill=!1,this.isRequire=!1,this.isOther=!1):"Z"==a?(this.isHeight=!1,this.isWeight=!1,this.isBMI=!1,this.isEye=!1,this.isAttendance=!1,this.isBasic=!0,this.$set(this.form,"operation_type","1"),this.isSkill=!1,this.isRequire=!1,this.isOther=!1):"J"==a?(this.isHeight=!1,this.isWeight=!1,this.isBMI=!1,this.isEye=!1,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!0,this.$set(this.form,"sports_id",l),this.$set(this.form,"operation_type","1"),this.isRequire=!1,this.isOther=!1):"2"==a?(this.isHeight=!1,this.isWeight=!1,this.isBMI=!1,this.isEye=!1,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!1,this.isRequire=!0,this.sportType=n,this.isOther=!1):(this.isHeight=!1,this.isWeight=!1,this.isBMI=!1,this.isEye=!1,this.isAttendance=!1,this.isBasic=!1,this.isSkill=!1,this.isRequire=!1,this.isOther=!0,this.$set(this.form,"operation_type","1")),this.$set(this.form,"yes_or_no",c),this.gradeId=o,this.form.student_ids=i,this.form.evaluation_project_id=s,this.semesterType=this.$options.filters["dictData"]("semester_type"),this.bmiLevel=this.$options.filters["dictData"]("bmi_level"),this.standardsRank=this.$options.filters["userDictData"]("standards_rank"),this.operationType=this.$options.filters["dictData"]("operation_type"),this.yesOrNoData=this.$options.filters["dictData"]("yes_or_no"),this.getChangeTypeTree()},getChangeTypeTree:function(){var e=this;Object(o["g"])().then((function(t){e.yearTree=t.data}))},handleSubmit:function(){var e=this;this.loading=!0,this.$refs.ruleForm.validate((function(t){if(!t)return e.loading=!1,!1;var i=JSON.parse(JSON.stringify(e.form));if(i.student_ids?i.student_ids=Array.isArray(i.student_ids)?i.student_ids.join("|"):i.student_ids:delete i.student_ids,"2"==e.activeKey){var s=i.afterScore-i.beforeScore;s>0?(i.operation_type="1",i.score=s):(i.operation_type="2",i.score=-s)}else delete e.form.record_id;Object(a["a"])(i).then((function(t){t.success?(e.visible=!1,e.$message.success("评价成功！"),e.$emit("ok",e.anchorPoint)):(e.loading=!1,e.$message.error("评价失败："+t.message))}))}))},handleCancel:function(){this.visible=!1}}},n=l,c=i("0c7c"),m=Object(c["a"])(n,s,r,!1,null,null,null);t["default"]=m.exports}}]);