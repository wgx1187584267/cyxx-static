(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b5e54"],{"1b9f":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.isEnter?t._e():e("div",[e("a-card",{attrs:{bordered:!1,bodyStyle:t.tstyle}},[e("a-form-model",{ref:"ruleForm",staticStyle:{width:"50%","margin-left":"20%","margin-top":"10%","margin-bottom":"10%"},attrs:{model:t.formContent,"label-col":t.labelCol,"wrapper-col":t.wrapperCol,rules:t.rules}},[e("a-form-model-item",{attrs:{label:"学年学期",prop:"ysValue"}},[e("a-cascader",{attrs:{fieldNames:t.fieldNames,options:t.yearTree,placeholder:"请选择学年学期","change-on-select":!1},model:{value:t.formContent.ysValue,callback:function(a){t.$set(t.formContent,"ysValue",a)},expression:"formContent.ysValue"}})],1),e("div",{staticStyle:{"margin-bottom":"20px",display:"flex","justify-content":"center"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("进入校级分析页面")])],1)],1)],1)],1),t.isEnter?e("div",[e("a-button",{attrs:{type:"link"},on:{click:t.goBack}},[e("a-icon",{attrs:{type:"arrow-left"}}),t._v("返回到选择页面")],1),e("a-card",{attrs:{loading:t.loading,"body-style":{padding:"0"}}},[e("div",{staticClass:"salesCard"},[e("a-tabs",{attrs:{"default-active-key":"1",size:"large","tab-bar-style":{marginBottom:"24px",paddingLeft:"16px"}}},[e("a-tab-pane",{key:"1",attrs:{loading:"true",tab:"小学部整体"}},[t.schoolData.length>0?e("a-row",{staticStyle:{display:"flex"}},[e("Pie",{ref:"schoolStatistics1",attrs:{dataSource:t.schoolMusicData,title:"音乐",idName:"schoolStatistics1",color:t.colors}}),e("Pie",{ref:"schoolStatistics2",attrs:{dataSource:t.schoolSportData,title:"体育",idName:"schoolStatistics2",color:t.colors}}),e("Pie",{ref:"schoolStatistics3",attrs:{dataSource:t.schoolArtData,title:"美术",idName:"schoolStatistics3",color:t.colors}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:t.simpleImage}})],1)],1),e("a-tab-pane",{key:"2",attrs:{tab:"音乐"}},[t.musicData.length>0?e("a-row",[e("div",{staticStyle:{float:"right","margin-right":"40px"}},[e("a-space",[e("a-button",{attrs:{type:"primary",icon:"line-chart"},on:{click:function(a){return t.$refs.detailDrawer.show(t.queryParam,t.musicId)}}},[t._v("详细图表")]),e("a-button",{attrs:{type:"primary",icon:"table"},on:{click:function(a){return t.$refs.tableDrawer.show(t.queryParam,t.musicId,"音乐校级")}}},[t._v("详细列表")])],1)],1)]):t._e(),t.musicData.length>0?e("a-row",[e("BarStacking",{ref:"musicStatistics",attrs:{dataSource:t.musicData,idName:"musicStatistics",color:t.colors,barTitle:"各等级人数统计图表"}}),e("LineStacking",{ref:"musicStatisticsLine",attrs:{dataSource:t.musicData,idName:"musicStatisticsLine",color:t.colors,lineTitle:"各等级占比统计图表"}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:t.simpleImage}})],1)],1),e("a-tab-pane",{key:"3",attrs:{tab:"体育"}},[t.sportData.length>0?e("a-row",[e("div",{staticStyle:{float:"right","margin-right":"40px"}},[e("a-space",[e("a-button",{attrs:{type:"primary",icon:"line-chart"},on:{click:function(a){return t.$refs.detailDrawer.show(t.queryParam,t.sportId)}}},[t._v("详细图表")]),e("a-button",{attrs:{type:"primary",icon:"table"},on:{click:function(a){return t.$refs.tableDrawer.show(t.queryParam,t.sportId,"体育校级")}}},[t._v("详细列表")])],1)],1)]):t._e(),t.sportData.length>0?e("a-row",[e("BarStacking",{ref:"sportStatistics",attrs:{dataSource:t.sportData,idName:"sportStatistics",color:t.colors,barTitle:"各等级人数统计图表"}}),e("LineStacking",{ref:"sportStatisticsLine",attrs:{dataSource:t.sportData,idName:"sportStatisticsLine",color:t.colors,lineTitle:"各等级占比统计图表"}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:t.simpleImage}})],1)],1),e("a-tab-pane",{key:"4",attrs:{tab:"美术"}},[t.artData.length>0?e("a-row",[e("div",{staticStyle:{float:"right","margin-right":"40px"}},[e("a-space",[e("a-button",{attrs:{type:"primary",icon:"line-chart"},on:{click:function(a){return t.$refs.detailDrawer.show(t.queryParam,t.artId)}}},[t._v("详细图表")]),e("a-button",{attrs:{type:"primary",icon:"table"},on:{click:function(a){return t.$refs.tableDrawer.show(t.queryParam,t.artId,"美术校级")}}},[t._v("详细列表")])],1)],1)]):t._e(),t.artData.length>0?e("a-row",[e("BarStacking",{ref:"artStatistics",attrs:{dataSource:t.artData,idName:"artStatistics",color:t.colors,barTitle:"各等级人数统计图表"}}),e("LineStacking",{ref:"artStatisticsLine",attrs:{dataSource:t.artData,idName:"artStatisticsLine",color:t.colors,lineTitle:"各等级占比统计图表"}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:t.simpleImage}})],1)],1)],1)],1)])],1):t._e(),e("detailDrawer",{ref:"detailDrawer"}),e("tableDrawer",{ref:"tableDrawer"})],1)},o=[],s=(e("06f4"),e("fc25")),i=(e("b0c0"),e("7db0"),e("d0fff")),l=e("0a43"),c=e("252a"),n=e("b19f"),u=e("ef19"),h=e("9012"),p=e("0964"),m=e("725d"),d={components:{BarStacking:l["default"],detailDrawer:u["default"],Pie:n["default"],tableDrawer:h["default"],LineStacking:c["default"]},data:function(){return{labelCol:{span:6},wrapperCol:{span:16},loading:!1,isEnter:!1,simpleImage:null,rules:{ysValue:[{required:!0,message:"请选择学年学期",trigger:"change"}]},fieldNames:{label:"name",value:"id",children:"children"},formContent:{ysValue:[]},tstyle:{"padding-bottom":"0px","margin-bottom":"10px"},yearTree:[],queryParam:{},colors:["#5470c6","#91cc75","#fac858","#ee6666"],schoolData:[],schoolMusicData:[],schoolSportData:[],schoolArtData:[],musicData:[],sportData:[],artData:[],musicId:null,sportId:null,artId:null}},beforeCreate:function(){this.simpleImage=s["a"].PRESENTED_IMAGE_SIMPLE},created:function(){this.getChangeTypeTree(),this.getSubjectInfo(),this.isEnter=!1},methods:{handleSubmit:function(){var t=this;this.loading=!0,this.$refs.ruleForm.validate((function(a){if(!a)return t.loading=!1,!1;var e=JSON.parse(JSON.stringify(t.formContent));e.ysValue&&e.ysValue.length?e.school_year=e.ysValue[0]:delete e.school_year,e.ysValue&&e.ysValue.length?e.semester=e.ysValue[1]:delete e.semester,delete e.ysValue,t.queryParam.school_year=e.school_year,t.queryParam.semester=e.semester,t.getStatistics(),t.isEnter=!0}))},getStatistics:function(){var t=this;Object(p["q"])(this.queryParam).then((function(a){if(a.success){t.loading=!1,t.schoolData=a.data.school_tatistics;var e=[];t.schoolMusicData.length=0,t.schoolSportData.length=0,t.schoolArtData.length=0;for(var r=0;r<t.schoolData.length;r++)e.push({name:t.schoolData[r].name,dataValue:[]}),"音乐"==t.schoolData[r].name?(t.schoolMusicData.push({name:"A",value:t.schoolData[r].valueA,percent:t.schoolData[r].percentA,itemStyle:{opacity:1}}),t.schoolMusicData.push({name:"B",value:t.schoolData[r].valueB,percent:t.schoolData[r].percentB,itemStyle:{opacity:1}}),t.schoolMusicData.push({name:"C",value:t.schoolData[r].valueC,percent:t.schoolData[r].percentC,itemStyle:{opacity:1}}),t.schoolMusicData.push({name:"D",value:t.schoolData[r].valueD,percent:t.schoolData[r].percentD,itemStyle:{opacity:1}})):"体育"==t.schoolData[r].name?(t.schoolSportData.push({name:"A",value:t.schoolData[r].valueA,percent:t.schoolData[r].percentA,itemStyle:{opacity:1}}),t.schoolSportData.push({name:"B",value:t.schoolData[r].valueB,percent:t.schoolData[r].percentB,itemStyle:{opacity:1}}),t.schoolSportData.push({name:"C",value:t.schoolData[r].valueC,percent:t.schoolData[r].percentC,itemStyle:{opacity:1}}),t.schoolSportData.push({name:"D",value:t.schoolData[r].valueD,percent:t.schoolData[r].percentD,itemStyle:{opacity:1}})):"美术"==t.schoolData[r].name&&(t.schoolArtData.push({name:"A",value:t.schoolData[r].valueA,percent:t.schoolData[r].percentA,itemStyle:{opacity:1}}),t.schoolArtData.push({name:"B",value:t.schoolData[r].valueB,percent:t.schoolData[r].percentB,itemStyle:{opacity:1}}),t.schoolArtData.push({name:"C",value:t.schoolData[r].valueC,percent:t.schoolData[r].percentC,itemStyle:{opacity:1}}),t.schoolArtData.push({name:"D",value:t.schoolData[r].valueD,percent:t.schoolData[r].percentD,itemStyle:{opacity:1}}));t.musicData=a.data.music_tatistics,t.sportData=a.data.sports_tatistics,t.artData=a.data.arts_tatistics}}))},getChangeTypeTree:function(){var t=this;Object(i["g"])().then((function(a){t.yearTree=t.deleteChildren(a.data)}))},deleteChildren:function(t){for(var a=t,e=a.length;e--;e>0)a[e].children&&(a[e].children.length?this.deleteChildren(a[e].children):delete a[e].children);return t},getSubjectInfo:function(){var t=this;Object(m["h"])().then((function(a){if(a.success){var e=a.data,r=e.find((function(t){return"音乐"===t.subject_name}));r&&(t.musicId=r.id);var o=e.find((function(t){return"体育"===t.subject_name}));o&&(t.sportId=o.id);var s=e.find((function(t){return"美术"===t.subject_name}));s&&(t.artId=s.id)}}))},goBack:function(){this.isEnter=!1,this.$forceUpdate()}}},y=d,f=e("0c7c"),D=Object(f["a"])(y,r,o,!1,null,null,null);a["default"]=D.exports}}]);