(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b97a7"],{"32b4":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[a.isEnter?a._e():e("div",[e("a-card",{attrs:{bordered:!1,bodyStyle:a.tstyle}},[e("a-form-model",{ref:"ruleForm",staticStyle:{width:"50%","margin-left":"20%","margin-top":"10%","margin-bottom":"10%"},attrs:{model:a.formContent,"label-col":a.labelCol,"wrapper-col":a.wrapperCol,rules:a.rules}},[e("a-form-model-item",{attrs:{label:"学年学期",prop:"ysValue"}},[e("a-cascader",{attrs:{fieldNames:a.fieldNames,options:a.yearTree,placeholder:"请选择学年学期","change-on-select":!1},model:{value:a.formContent.ysValue,callback:function(t){a.$set(a.formContent,"ysValue",t)},expression:"formContent.ysValue"}})],1),e("a-form-model-item",{attrs:{label:"班级",prop:"fwValue"}},[e("ClassSelect",{ref:"classSelect",attrs:{placeholder:"请选择班级",changeOnSelect:!0,academicStage:"1"},model:{value:a.formContent.fwValue,callback:function(t){a.$set(a.formContent,"fwValue",t)},expression:"formContent.fwValue"}})],1),e("div",{staticStyle:{"margin-bottom":"20px",display:"flex","justify-content":"center"}},[e("a-button",{attrs:{type:"primary"},on:{click:a.handleSubmit}},[a._v("进入班级分析页面")])],1)],1)],1)],1),a.isEnter?e("div",[e("a-button",{attrs:{type:"link"},on:{click:a.goBack}},[e("a-icon",{attrs:{type:"arrow-left"}}),a._v("返回到选择页面")],1),e("x-card",[e("div",{staticClass:"table-page-search-wrapper",attrs:{slot:"content"},slot:"content"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:48}},[e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"班级"}},[e("ClassSelect",{attrs:{changeOnSelect:!0,allowClear:!1,placeholder:"请选择班级",academicStage:"1"},model:{value:a.queryParam.classSelData,callback:function(t){a.$set(a.queryParam,"classSelData",t)},expression:"queryParam.classSelData"}})],1)],1),e("a-col",{attrs:{md:a.advanced?24:8,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",style:a.advanced&&{float:"right",overflow:"hidden"}||{}},[e("h-search-button",{on:{click:a.searchInfo}})],1)])],1)],1)],1)]),e("a-card",{attrs:{loading:a.loading,"body-style":{padding:"0"}}},[e("div",{staticClass:"salesCard"},[e("a-tabs",{attrs:{"default-active-key":"1",size:"large","tab-bar-style":{marginBottom:"24px",paddingLeft:"16px"}}},[e("a-tab-pane",{key:"1",attrs:{loading:"true",tab:"班级整体"}},[a.schoolData.length>0?e("a-row",{staticStyle:{display:"flex"}},[e("Pie",{ref:"schoolStatistics1",attrs:{dataSource:a.schoolMusicData,title:"音乐",idName:"schoolStatistics1",color:a.colors}}),e("Pie",{ref:"schoolStatistics2",attrs:{dataSource:a.schoolSportData,title:"体育",idName:"schoolStatistics2",color:a.colors}}),e("Pie",{ref:"schoolStatistics3",attrs:{dataSource:a.schoolArtData,title:"美术",idName:"schoolStatistics3",color:a.colors}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:a.simpleImage}})],1)],1),e("a-tab-pane",{key:"2",attrs:{tab:"音乐"}},[a.musicData.length>0?e("a-row",[e("div",{staticStyle:{float:"right","margin-right":"40px"}},[e("a-space",[e("a-button",{attrs:{type:"primary",icon:"table"},on:{click:function(t){return a.$refs.tableDrawer.show(a.queryParam,a.musicId,"音乐")}}},[a._v("详细列表")])],1)],1)]):a._e(),a.musicData.length>0?e("a-row",[e("BarStacking",{ref:"musicStatistics",attrs:{dataSource:a.musicData,idName:"musicStatistics",color:a.colors}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:a.simpleImage}})],1)],1),e("a-tab-pane",{key:"3",attrs:{tab:"体育"}},[a.sportData.length>0?e("a-row",[e("div",{staticStyle:{float:"right","margin-right":"40px"}},[e("a-space",[e("a-button",{attrs:{type:"primary",icon:"table"},on:{click:function(t){return a.$refs.tableDrawer.show(a.queryParam,a.sportId,"体育")}}},[a._v("详细列表")])],1)],1)]):a._e(),a.sportData.length>0?e("a-row",[e("BarStacking",{ref:"sportStatistics",attrs:{dataSource:a.sportData,idName:"sportStatistics",color:a.colors}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:a.simpleImage}})],1)],1),e("a-tab-pane",{key:"4",attrs:{tab:"美术"}},[a.artData.length>0?e("a-row",[e("div",{staticStyle:{float:"right","margin-right":"40px"}},[e("a-space",[e("a-button",{attrs:{type:"primary",icon:"table"},on:{click:function(t){return a.$refs.tableDrawer.show(a.queryParam,a.artId,"美术")}}},[a._v("详细列表")])],1)],1)]):a._e(),a.artData.length>0?e("a-row",[e("BarStacking",{ref:"artStatistics",attrs:{dataSource:a.artData,idName:"artStatistics",color:a.colors}})],1):e("a-row",[e("a-empty",{staticStyle:{margin:"40px 0"},attrs:{image:a.simpleImage}})],1)],1)],1)],1)])],1):a._e(),e("tableDrawer",{ref:"tableDrawer"})],1)},l=[],r=(e("06f4"),e("fc25")),o=(e("7db0"),e("b0c0"),e("d0fff")),c=e("0a43"),i=e("b19f"),n=e("0964"),u=e("725d"),h=e("ad81"),d=e("2af9"),m=e("9367"),p={components:{BarStacking:c["default"],ClassSelect:h["a"],XCard:d["w"],Pie:i["default"],tableDrawer:m["default"]},data:function(){return{labelCol:{span:6},wrapperCol:{span:16},loading:!1,isEnter:!1,advanced:!1,simpleImage:null,rules:{ysValue:[{required:!0,message:"请选择学年学期",trigger:"change"}],fwValue:[{required:!0,message:"请选择班级",trigger:"change"}]},fieldNames:{label:"name",value:"id",children:"children"},formContent:{ysValue:[],fwValue:[]},tstyle:{"padding-bottom":"0px","margin-bottom":"10px"},yearTree:[],queryParam:{classSelData:[]},colors:["#5470c6","#91cc75","#fac858","#ee6666"],schoolData:[],schoolMusicData:[],schoolSportData:[],schoolArtData:[],musicData:[],sportData:[],artData:[],musicId:null,sportId:null,artId:null}},beforeCreate:function(){this.simpleImage=r["a"].PRESENTED_IMAGE_SIMPLE},created:function(){this.getChangeTypeTree(),this.getSubjectInfo(),this.isEnter=!1},methods:{handleSubmit:function(){var a=this;this.loading=!0,this.$refs.ruleForm.validate((function(t){if(!t)return a.loading=!1,!1;var e=JSON.parse(JSON.stringify(a.formContent));e.fwValue&&e.fwValue.length?e.grade_id=e.fwValue[0]:delete e.grade_id,e.fwValue&&e.fwValue.length?e.class_id=e.fwValue[1]:delete e.class_id,delete e.fwValue,e.ysValue&&e.ysValue.length?e.school_year=e.ysValue[0]:delete e.school_year,e.ysValue&&e.ysValue.length?e.semester=e.ysValue[1]:delete e.semester,delete e.ysValue,a.queryParam.school_year=e.school_year,a.queryParam.semester=e.semester,a.queryParam.classSelData=[e.grade_id,e.class_id],a.getStatistics(),a.isEnter=!0}))},getSubjectInfo:function(){var a=this;Object(u["h"])().then((function(t){if(t.success){var e=t.data,s=e.find((function(a){return"音乐"===a.subject_name}));s&&(a.musicId=s.id);var l=e.find((function(a){return"体育"===a.subject_name}));l&&(a.sportId=l.id);var r=e.find((function(a){return"美术"===a.subject_name}));r&&(a.artId=r.id)}}))},getStatistics:function(){var a=this,t=JSON.parse(JSON.stringify(this.queryParam));t.classSelData&&t.classSelData.length?t.grade_id=t.classSelData[0]:delete t.grade_id,t.classSelData&&t.classSelData.length?t.class_id=t.classSelData[1]:delete t.class_id,delete t.classSelData,Object(n["c"])(t).then((function(t){if(t.success){a.loading=!1,a.schoolData=t.data.school_tatistics,a.schoolMusicData.length=0,a.schoolSportData.length=0,a.schoolArtData.length=0;for(var e=[],s=0;s<a.schoolData.length;s++)e.push({name:a.schoolData[s].name,dataValue:[]}),"音乐"==a.schoolData[s].name?(a.schoolMusicData.push({name:"A",value:a.schoolData[s].valueA,percent:a.schoolData[s].percentA,itemStyle:{opacity:1}}),a.schoolMusicData.push({name:"B",value:a.schoolData[s].valueB,percent:a.schoolData[s].percentB,itemStyle:{opacity:1}}),a.schoolMusicData.push({name:"C",value:a.schoolData[s].valueC,percent:a.schoolData[s].percentC,itemStyle:{opacity:1}}),a.schoolMusicData.push({name:"D",value:a.schoolData[s].valueD,percent:a.schoolData[s].percentD,itemStyle:{opacity:1}})):"体育"==a.schoolData[s].name?(a.schoolSportData.push({name:"A",value:a.schoolData[s].valueA,percent:a.schoolData[s].percentA,itemStyle:{opacity:1}}),a.schoolSportData.push({name:"B",value:a.schoolData[s].valueB,percent:a.schoolData[s].percentB,itemStyle:{opacity:1}}),a.schoolSportData.push({name:"C",value:a.schoolData[s].valueC,percent:a.schoolData[s].percentC,itemStyle:{opacity:1}}),a.schoolSportData.push({name:"D",value:a.schoolData[s].valueD,percent:a.schoolData[s].percentD,itemStyle:{opacity:1}})):"美术"==a.schoolData[s].name&&(a.schoolArtData.push({name:"A",value:a.schoolData[s].valueA,percent:a.schoolData[s].percentA,itemStyle:{opacity:1}}),a.schoolArtData.push({name:"B",value:a.schoolData[s].valueB,percent:a.schoolData[s].percentB,itemStyle:{opacity:1}}),a.schoolArtData.push({name:"C",value:a.schoolData[s].valueC,percent:a.schoolData[s].percentC,itemStyle:{opacity:1}}),a.schoolArtData.push({name:"D",value:a.schoolData[s].valueD,percent:a.schoolData[s].percentD,itemStyle:{opacity:1}}));a.musicData=t.data.music_tatistics,a.sportData=t.data.sports_tatistics,a.artData=t.data.arts_tatistics}}))},getChangeTypeTree:function(){var a=this;Object(o["g"])().then((function(t){a.yearTree=a.deleteChildren(t.data)}))},deleteChildren:function(a){for(var t=a,e=t.length;e--;e>0)t[e].children&&(t[e].children.length?this.deleteChildren(t[e].children):delete t[e].children);return a},goBack:function(){this.isEnter=!1,this.$forceUpdate()},searchInfo:function(){this.loading=!0,this.getStatistics(),this.$refs.schoolStatistics.initEcharts(),this.$refs.musicStatistics.initEcharts(),this.$refs.sportStatistics.initEcharts(),this.$refs.artStatistics.initEcharts()}}},f=p,g=e("0c7c"),y=Object(g["a"])(f,s,l,!1,null,null,null);t["default"]=y.exports}}]);