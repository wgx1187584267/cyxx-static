(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44343f94","chunk-2d0dd3af"],{"0f64":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-modal",{attrs:{destroyOnClose:!0,title:t.modalTitle,width:900,visible:t.visible,bodyStyle:t.bodyStyle,footer:null},on:{cancel:t.handleCancel}},[n("a-card",{attrs:{bordered:!1}},[1==t.form.question_type||2==t.form.question_type?n("div",{staticStyle:{background:"#f4f4f4",padding:"15px 15px 15px 0","margin-bottom":"15px","border-radius":"10px"}},[n("a-row",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"flex",align:"middle"}},[n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("题干：")]),n("a-col",{attrs:{span:15}},[n("div",{staticClass:"myText",domProps:{innerHTML:t._s(t.form.stem)},on:{click:function(e){return t.$refs.editorModal.showModal("stem",t.form.stem)}}})]),n("a-col",{attrs:{span:3}},[n("a-checkbox",{staticStyle:{"margin-left":"10px"},attrs:{checked:!!Number(t.form.must_answer)},on:{change:t.onChangeMustAnswer}},[t._v("必答")])],1)],1),n("div",[t._l(t.form.questionnaire_question_option,(function(e,i){return n("a-row",{key:e.id||e.key,staticStyle:{"margin-bottom":"15px"}},[1==t.form.question_type?n("a-radio-group",{staticStyle:{width:"100%"},model:{value:t.singleAnswer,callback:function(e){t.singleAnswer=e},expression:"singleAnswer"}},[n("a-col",{staticStyle:{"text-align":"right",display:"inline-flex","flex-direction":"row","align-items":"baseline","justify-content":"flex-end","flex-wrap":"nowrap"},attrs:{span:3}},[n("a-radio",{style:t.radioStyle,attrs:{value:e.sort}}),n("div",[t._v("选项"+t._s(String.fromCharCode(Number(i)+65))+"：")])],1),n("a-col",{attrs:{span:13}},[n("span",{staticClass:"myText",domProps:{innerHTML:t._s(e.content)},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.$refs.editorModal.showModal("questionnaire_question_option",e.content,i)}}})]),n("a-col",{attrs:{span:5}},[n("div",{staticStyle:{display:"flex","flex-direction":"column","flex-wrap":"nowrap","align-items":"baseline","justify-content":"center"}},[n("a-checkbox",{staticStyle:{margin:"8px 0 0 15px"},attrs:{checked:"1"==e.is_fill},on:{change:function(n){return t.onChangeFill(n,e)}}},[t._v("可否填空")]),n("div",[t._v(" 选项分值： "),n("a-input-number",{staticStyle:{"margin-top":"10px"},attrs:{id:"inputNumber",min:0,placeholder:"选项分值",size:"small"},model:{value:e.score,callback:function(n){t.$set(e,"score",n)},expression:"item.score"}})],1)],1)]),n("a-col",{attrs:{span:3}},[n("a-button",{staticStyle:{margin:"8px 0 0 25px"},attrs:{type:"danger",shape:"circle",icon:"close"},on:{click:function(n){return t.removeOption(e)}}})],1)],1):t._e(),2==t.form.question_type?n("div",{staticStyle:{width:"100%"}},[n("a-col",{staticStyle:{"text-align":"right",display:"inline-flex","flex-direction":"row","align-items":"baseline","justify-content":"flex-end","flex-wrap":"nowrap"},attrs:{span:3}},[n("a-checkbox",{style:t.radioStyle,attrs:{checked:t.multipleAnswer.includes(e.sort),value:e.sort},on:{change:function(n){return t.onChangeAnswer(n,e)}}}),n("div",[t._v("选项"+t._s(String.fromCharCode(Number(i)+65))+"：")])],1),n("a-col",{attrs:{span:13}},[n("span",{staticClass:"myText",domProps:{innerHTML:t._s(e.content)},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.$refs.editorModal.showModal("questionnaire_question_option",e.content,i)}}})]),n("a-col",{attrs:{span:5}},[n("div",{staticStyle:{display:"flex","flex-direction":"column","flex-wrap":"nowrap","align-items":"baseline","justify-content":"center"}},[n("a-checkbox",{staticStyle:{margin:"8px 0 0 15px"},attrs:{checked:"1"==e.is_fill},on:{change:function(n){return t.onChangeFill(n,e)}}},[t._v("可否填空")]),n("div",[t._v(" 选项分值： "),n("a-input-number",{staticStyle:{"margin-top":"10px"},attrs:{id:"inputNumber",min:0,placeholder:"选项分值",size:"small"},model:{value:e.score,callback:function(n){t.$set(e,"score",n)},expression:"item.score"}})],1)],1)]),n("a-col",{attrs:{span:3}},[n("a-button",{staticStyle:{margin:"8px 0 0 25px"},attrs:{type:"danger",shape:"circle",icon:"close"},on:{click:function(n){return t.removeOption(e)}}})],1)],1):t._e()],1)})),1==t.form.question_type||2==t.form.question_type||4==t.form.question_type?n("a-button",{staticStyle:{width:"80%","margin-left":"88px"},attrs:{type:"dashed"},on:{click:t.addOption}},[n("a-icon",{attrs:{type:"plus"}}),t._v("添加选项")],1):t._e()],2)],1):t._e(),3==t.form.question_type||4==t.form.question_type||5==t.form.question_type?n("div",[n("p",[t._v(" 请在下方输入题干内容："),n("span",{directives:[{name:"show",rawName:"v-show",value:4==t.form.question_type,expression:"form.question_type == 4"}]},[t._v("（中间需要填空的请点击“插入填空符”按钮）"),n("a-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:t.insertBlankFn}},[t._v("插入填空符")])],1)]),n("j-editor",{attrs:{editorHeight:320},on:{onClick:t.onClickEditor},model:{value:t.form.stem,callback:function(e){t.$set(t.form,"stem",e)},expression:"form.stem"}}),n("a-checkbox",{staticStyle:{"margin-top":"20px"},attrs:{checked:!!Number(t.form.must_answer)},on:{change:t.onChangeMustAnswer}},[t._v("必答")])],1):t._e(),n("div",{staticStyle:{background:"#f4f4f4",padding:"15px 15px 15px 0","margin-bottom":"15px","border-radius":"10px"}},[n("a-row",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"flex",align:"middle"}},[n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("问题分值：")]),n("a-col",{attrs:{span:18}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"inputNumber",min:0},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1)],1),3==t.form.question_type?n("a-row",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"flex",align:"middle"}},[n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("问题答案：")]),n("a-col",{attrs:{span:18}},[n("a-radio-group",{model:{value:t.judgeAnswer,callback:function(e){t.judgeAnswer=e},expression:"judgeAnswer"}},[n("a-radio",{attrs:{value:!0}},[t._v(" 正确 ")]),n("a-radio",{attrs:{value:!1}},[t._v(" 错误 ")])],1)],1)],1):t._e(),4==t.form.question_type?n("a-row",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"flex",align:"middle"}},[n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("问题答案：")]),n("a-col",{attrs:{span:18}},t._l(t.form.questionnaire_question_option,(function(e,i){return n("div",{key:e.id||e.key,staticStyle:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","align-items":"center","margin-bottom":"5px"}},[n("span",[t._v(t._s(i+1)+"、")]),n("span",{staticClass:"myText",staticStyle:{"margin-right":"15px",height:"30px"},domProps:{innerHTML:t._s(e.content)},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.$refs.editorModal.showModal("questionnaire_question_option",e.content,i)}}})])})),0)],1):t._e(),5==t.form.question_type?n("a-row",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"flex",align:"middle"}},[n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("问题答案：")]),n("a-col",{attrs:{span:18}},[n("div",{staticClass:"myText",domProps:{innerHTML:t._s(t.form.question_answer)},on:{click:function(e){return t.$refs.editorModal.showModal("question_answer",t.form.question_answer)}}})])],1):t._e(),n("a-row",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"flex",align:"middle"}},[n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t._v("问题解析：")]),n("a-col",{attrs:{span:18}},[n("div",{staticClass:"myText",domProps:{innerHTML:t._s(t.form.analysis)},on:{click:function(e){return t.$refs.editorModal.showModal("analysis",t.form.analysis)}}})])],1)],1),n("div",{staticClass:"btn"},[n("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("保存")]),n("a-button",{staticStyle:{"margin-left":"20px"},on:{click:t.handleCancel}},[t._v("关闭")])],1),n("EditorModal",{ref:"editorModal",on:{ok:t.handleOK}})],1)],1)},s=[],o=(n("a9e3"),n("d81d"),n("ac1f"),n("1276"),n("fb6a"),n("a15b"),n("5319"),n("466d"),n("a434"),n("159b"),n("4de4"),n("a630"),n("3ca3"),n("d3b7"),n("6062"),n("ddb0"),n("e562")),r=n.n(o),a=n("0b996"),l=n("8100"),c={name:"SubjectAddEditModal",components:{EditorModal:l["default"],JEditor:a["a"]},data:function(){return{visible:!1,bodyStyle:{padding:"0"},modalWidth:800,radioStyle:{display:"block",height:"40px",lineHeight:"40px",marginBottom:"30px"},editorID:null,form:{question_type:1,stem:"",must_answer:0,questionnaire_question_option:[{key:Date.now(),content:"",sort:1,is_fill:"0"}],score:0,question_answer:"",analysis:""},blockIndex:null,multipleAnswer:[],singleAnswer:0,judgeAnswer:!0,blanksAnswer:[{id:1}],score_correspondence:"",set_answer:"",blank_count:""}},computed:{modalTitle:function(){return 1===this.form.question_type?"单选题":2===this.form.question_type?"多选题":3===this.form.question_type?"判断题":4===this.form.question_type?"填空题":5===this.form.question_type?"问答题":"题目"}},created:function(){},methods:{add:function(t,e,n,i){this.score_correspondence=n,this.set_answer=i,this.blockIndex=e,this.form=Object.assign({},this.$options.data().form),this.form.question_type=t,this.multipleAnswer=[],this.singleAnswer=0,this.judgeAnswer=!0,this.blanksAnswer=[{id:1}],this.visible=!0},edit:function(t,e,n,i){this.score_correspondence=n,this.set_answer=i,this.blockIndex=e;var s=JSON.parse(JSON.stringify(t));this.form=s,1===s.question_type?this.singleAnswer=Number(s.question_answer):2===s.question_type?this.multipleAnswer=s.question_answer.split("|").map(Number):3===s.question_type?(this.judgeAnswer=JSON.parse(s.question_answer),this.form.questionnaire_question_option=[]):4===s.question_type||5===s.question_type&&(this.form.questionnaire_question_option=[]),this.visible=!0},handleSubmit:function(){var t=JSON.parse(JSON.stringify(this.form));if(1===t.question_type)t.question_answer=this.singleAnswer+"";else if(2===t.question_type){var e=this.multipleAnswer.slice().sort((function(t,e){return t-e}));t.question_answer=e.join("|")}else 3===t.question_type?(t.question_answer=this.judgeAnswer+"",t.questionnaire_question_option=[]):4===t.question_type?t.question_answer=t.questionnaire_question_option.map((function(t){return t.content.replace(/<[^>]+>/g,"")})).join("|"):5===t.question_type&&(t.question_answer=t.question_answer.replace(/<[^>]+>/g,""),t.questionnaire_question_option=[]);if("1"==this.set_answer){if("0"==t.question_answer||!t.question_answer)return this.$message.error("未设置问题答案"),!1;if(2===t.question_type&&this.multipleAnswer.length<2)return this.$message.error("请选择多个选项"),!1}if("1"==this.score_correspondence){if(1===t.question_type||2===t.question_type){var n=t.questionnaire_question_option.every((function(t){return t.hasOwnProperty("score")&&Number(t.score)>=0}));if(0==n)return this.$message.error("未设置选项分值"),!1}if(Number(t.score)<=0)return this.$message.error("未设置问题分值"),!1}this.$emit("ok",t,this.blockIndex),this.visible=!1},handleCancel:function(){this.visible=!1},calculateBlanks:function(t){return(t.match(/_+/g)||[]).length},removeOption:function(t){var e=this,n=this.form.questionnaire_question_option.indexOf(t);-1!==n&&(this.form.questionnaire_question_option.splice(n,1),this.form.questionnaire_question_option.forEach((function(t,e){t.sort=e+1})),2===this.form.question_type&&(this.multipleAnswer=this.multipleAnswer.filter((function(t){if(t<=e.form.questionnaire_question_option.length)return t}))))},addOption:function(){this.form.questionnaire_question_option.push({key:Date.now(),content:"",is_fill:"0",sort:this.form.questionnaire_question_option.length+1})},handleOK:function(t){"undefined"===typeof t.index?this.form[t.key]=t.val:this.form[t.key][t.index]["content"]=t.val},onChangeMustAnswer:function(t){this.form.must_answer=t.target.checked?1:0},onChangeFill:function(t,e){1==t.target.checked?e.is_fill="1":0==t.target.checked&&(e.is_fill="0")},onChangeAnswer:function(t,e){if(e.checked=t.target.checked,1==e.checked){var n=this.multipleAnswer;n.push(e.sort),this.multipleAnswer=Array.from(new Set(n))}else{var i=this.multipleAnswer.indexOf(e.sort);i>-1&&(this.multipleAnswer=this.multipleAnswer.filter((function(t){if(e.sort!==t)return t})))}},onClickEditor:function(t,e){this.editorID=e},insertBlankFn:function(){r.a.editors[this.editorID].insertContent("_");var t=this.calculateBlanks(this.form.stem);this.blank_count=Number(t)+1,this.form.questionnaire_question_option=[];for(var e=0;e<this.blank_count;e++)this.form.questionnaire_question_option.push({id:e+1,content:"",sort:e+1,is_fill:0})}}},u=c,p=(n("ac81"),n("0c7c")),d=Object(p["a"])(u,i,s,!1,null,"883027b0",null);e["default"]=d.exports},8100:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-modal",{attrs:{title:"编辑内容",width:t.modalWidth,destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("j-editor",{attrs:{editorHeight:t.editorHeight},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1)},s=[],o=n("0b996"),r={components:{JEditor:o["a"]},data:function(){return{isShow:!1,visible:!1,editorHeight:500,modalWidth:900,content:"",key:"",index:""}},created:function(){},methods:{showModal:function(t,e,n){this.isShow=!0,this.visible=!0,this.content=e,this.key=t,this.index=n},handleOk:function(t){this.isShow=!1,this.visible=!1,this.$emit("ok",{key:this.key,val:this.content,index:this.index})},handleCancel:function(){this.isShow=!1,this.visible=!1}}},a=r,l=n("0c7c"),c=Object(l["a"])(a,i,s,!1,null,null,null);e["default"]=c.exports},a2e4:function(t,e,n){},ac81:function(t,e,n){"use strict";n("a2e4")}}]);