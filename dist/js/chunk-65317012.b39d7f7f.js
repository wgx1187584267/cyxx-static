(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65317012","chunk-903bfd4c","chunk-61cd18aa","chunk-03f22e04"],{"11bcb":function(t,e,a){},"174c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-card",{attrs:{bordered:!1,bodyStyle:t.tstyle}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"学年学期"}},[a("a-cascader",{attrs:{fieldNames:t.fieldNames,options:t.yearTree,placeholder:"请选择学年学期","change-on-select":!1},model:{value:t.queryParam.ysValue,callback:function(e){t.$set(t.queryParam,"ysValue",e)},expression:"queryParam.ysValue"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"问卷标题"}},[a("a-input",{staticStyle:{width:"100%"},attrs:{"allow-clear":"",placeholder:"请输入问卷标题"},model:{value:t.queryParam.questionnaire_title,callback:function(e){t.$set(t.queryParam,"questionnaire_title",e)},expression:"queryParam.questionnaire_title"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("h-search-button",{on:{click:function(e){return t.$refs.table.refresh(!0)}}}),a("h-reset-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return t.queryParam={ysValue:[]}}}})],1)])],1)],1)],1)]),a("a-card",{attrs:{bordered:!1}},[a("s-table",{ref:"table",attrs:{columns:t.columns,data:t.loadData,alert:!1,rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"read_num",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:"#2db7f5"}},[t._v(t._s(e)+" 次")])],1)}},{key:"state",fn:function(e,n){return a("span",{},[a("a-switch",{attrs:{"checked-children":"发布","un-checked-children":"停用",checked:0==e},on:{change:function(e){return t.handleState(n)}}})],1)}},{key:"action",fn:function(e,n){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.previewModal.showModal(n)}}},[t._v("预览")]),a("a-divider",{attrs:{type:"vertical"}}),a("h-link",{attrs:{type:"warning"},nativeOn:{click:function(e){return t.$refs.addEditForm.edit(n)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("h-link",{attrs:{type:"success"},nativeOn:{click:function(e){return t.$refs.recyclingDetailsModal.showModal(n)}}},[t._v("回收情况")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{placement:"topRight",title:"确认删除？"},on:{confirm:function(){return t.handleDelete(n)}}},[a("h-link",{attrs:{type:"danger"}},[t._v("删除")])],1)],1)}}])},[a("div",{staticClass:"table-operator",attrs:{slot:"operator"},slot:"operator"},[a("h-button",{attrs:{type:"success",icon:"plus"},on:{click:function(e){return t.$refs.addEditForm.add()}}},[t._v("创建问卷")])],1)])],1),a("AddEditForm",{ref:"addEditForm",on:{ok:t.handleOk}}),a("PreviewModal",{ref:"previewModal"}),a("QuestionnaireLinkModal",{ref:"questionnaireLinkModal"}),a("RecyclingDetailsModal",{ref:"recyclingDetailsModal"})],1)},s=[],i=a("2af9"),r=a("4a1d"),o=a("7d29c"),l=a("31c0"),c=a("50fc"),u=a("322f"),d=a("d0fff"),f={components:{STable:i["r"],AddEditForm:o["default"],PreviewModal:l["default"],QuestionnaireLinkModal:c["default"],RecyclingDetailsModal:u["default"]},data:function(){var t=this;return{queryParam:{ysValue:[]},fieldNames:{label:"name",value:"id",children:"children"},yearTree:[],columns:[{title:"学年",align:"center",dataIndex:"school_year_name"},{title:"学期",align:"center",dataIndex:"semester_name"},{title:"问卷标题",align:"center",dataIndex:"questionnaire_title"},{title:"创建人",align:"center",dataIndex:"add_person_name"},{title:"创建时间",align:"center",dataIndex:"add_time"},{title:"发布/停用",width:"80px",align:"center",dataIndex:"state",scopedSlots:{customRender:"state"}},{title:"阅读量",align:"center",dataIndex:"read_num",scopedSlots:{customRender:"read_num"}},{title:"操作",width:"290px",align:"center",dataIndex:"action",scopedSlots:{customRender:"action"}}],tstyle:{"padding-bottom":"0px","margin-bottom":"10px"},loadData:function(e){return Object(r["f"])(Object.assign(e,t.switchingDate())).then((function(t){return t.data}))}}},created:function(){this.getChangeTypeTree()},methods:{switchingDate:function(){var t=JSON.parse(JSON.stringify(this.queryParam));return t.ysValue&&t.ysValue.length?t.school_year=t.ysValue[0]:delete t.school_year,t.ysValue&&t.ysValue.length?t.semester=t.ysValue[1]:delete t.semester,delete t.ysValue,t},handleDelete:function(t){var e=this;Object(r["b"])({id:t.id}).then((function(t){t.success?(e.$message.success("删除成功"),e.$refs.table.refresh()):e.$message.error("删除失败："+t.message)}))},getChangeTypeTree:function(){var t=this;Object(d["g"])().then((function(e){t.yearTree=t.deleteChildren(e.data)}))},deleteChildren:function(t){for(var e=t,a=e.length;a--;a>0)e[a].children&&(e[a].children.length?this.deleteChildren(e[a].children):delete e[a].children);return t},handleState:function(t){var e=this,a=0===t.state?1:0;Object(r["i"])({id:t.id,state:a}).then((function(t){t.success?(e.$message.success("操作成功"),e.$refs.table.refresh()):e.$message.error("操作失败："+t.message)}))},handleOk:function(){this.$refs.table.refresh()}}},p=f,h=(a("2a7b"),a("0c7c")),m=Object(h["a"])(p,n,s,!1,null,null,null);e["default"]=m.exports},"2a7b":function(t,e,a){"use strict";a("8a39")},"31c0":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{title:"问卷预览",width:800,footer:null},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("h2",{staticClass:"title"},[t._v(t._s(t.form.questionnaire_title))]),t.form.questionnaire_describe?a("p",[t._v(t._s(t.form.questionnaire_describe))]):t._e(),a("a-divider",{attrs:{dashed:""}}),t._l(t.form.questionnaire_question,(function(e,n){return a("span",{key:e.key||e.id,staticClass:"content"},[1==e.question_type||2==e.question_type?a("div",{staticStyle:{"margin-bottom":"25px"}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("h3",[a("span",{class:Number(e.must_answer)?"star":""},[t._v(t._s(n+1)+"、")]),a("span",{domProps:{innerHTML:t._s(e.stem)}})])])],1),t._l(e.questionnaire_question_option,(function(n){return a("div",{key:n.sort||n.id,staticStyle:{"text-indent":"24px","margin-bottom":"10px"}},[1==e.question_type?a("span",{staticClass:"circular"}):t._e(),2==e.question_type?a("span",{staticClass:"square"}):t._e(),a("span",{domProps:{innerHTML:t._s(n.content)}}),n.is_fill?a("span",[t._v("___")]):t._e()])})),a("a-divider",{attrs:{dashed:""}})],2):t._e(),3==e.question_type||4==e.question_type||5==e.question_type?a("div",{staticStyle:{"margin-bottom":"25px"}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("h3",[a("span",{class:Number(e.must_answer)?"star":""},[t._v(t._s(n+1)+"、")]),a("span",{domProps:{innerHTML:t._s(e.stem)}})])])],1),3==e.question_type?a("div",{staticStyle:{"text-indent":"24px"}},[a("p",[a("span",{staticClass:"circular"}),t._v(" 正确")]),a("p",[a("span",{staticClass:"circular"}),t._v(" 错误")])]):t._e(),5==e.question_type?a("div",{staticClass:"rectangle"}):t._e(),a("a-divider",{attrs:{dashed:""}})],1):t._e()])}))],2)],1)},s=[],i={data:function(){return{visible:!1,form:{}}},methods:{showModal:function(t){this.form=t,this.visible=!0},handleOk:function(t){this.visible=!1}}},r=i,o=(a("705a"),a("0c7c")),l=Object(o["a"])(r,n,s,!1,null,"0bfb6875",null);e["default"]=l.exports},"322f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{width:650,title:"回收详情"},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("s-table",{ref:"table",attrs:{columns:t.columns,data:t.loadData,alert:!1,rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"answer_time",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:"cyan"}},[t._v(t._s(e)+"分钟")])],1)}},{key:"action",fn:function(e,n){return a("span",{},[a("h-link",{attrs:{type:"success"},nativeOn:{click:function(e){return t.$refs.previewResultModal.showModal(n)}}},[t._v("详情")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{placement:"topRight",title:"确认删除？"},on:{confirm:function(){return t.handleDelete(n.id)}}},[a("h-link",{attrs:{type:"danger"}},[t._v("删除")])],1)],1)}}])})],1),a("PreviewResultModal",{ref:"previewResultModal"})],1)},s=[],i=a("2af9"),r=a("4a1d"),o=a("699d"),l={components:{STable:i["r"],PreviewResultModal:o["default"]},data:function(){var t=this;return{visible:!1,queryParam:{questionnaire_id:""},columns:[{title:"问卷回收时间",align:"center",dataIndex:"retrieving_time"},{title:"答题时长",align:"center",dataIndex:"answer_time",scopedSlots:{customRender:"answer_time"}},{title:"操作",width:"100px",dataIndex:"action",scopedSlots:{customRender:"action"}}],tstyle:{"padding-bottom":"0px","margin-bottom":"10px"},loadData:function(e){return Object(r["h"])(Object.assign(e,t.queryParam)).then((function(t){return t.data}))}}},methods:{showModal:function(t){this.queryParam.questionnaire_id=t.id;try{this.$refs.table.refresh()}catch(e){}this.visible=!0},handleDelete:function(t){var e=this;Object(r["g"])({id:t.id}).then((function(t){t.success?(e.$message.success("删除成功"),e.$refs.table.refresh()):e.$message.error("删除失败："+t.message)}))},handleOk:function(t){this.visible=!1}}},c=l,u=a("0c7c"),d=Object(u["a"])(c,n,s,!1,null,null,null);e["default"]=d.exports},"50fc":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-modal",{attrs:{title:"问卷链接",width:900,footer:null},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("a-row",[n("a-col",{staticStyle:{background:"#DCDFE6 !important"},attrs:{span:12}},[n("div",{ref:"cardContent",staticStyle:{background:"#DCDFE6 !important",padding:"20px 0"}},[n("div",{staticClass:"cardContent"},[n("div",{staticClass:"logo"},[n("img",{staticClass:"icon-logo logo-ksx",attrs:{src:"/logo.webp"}})]),n("div",{staticClass:"title"},[n("p",{staticClass:"invite"},[t._v("—— 邀请你参加 ——")]),n("p",{staticClass:"title_content"},[t._v(t._s(t.form.questionnaire_title))])]),n("div",{staticClass:"qr_code"},[n("vue-qr",{attrs:{text:t.url,margin:0,colorDark:"#ef9b27",colorLight:"#fff",size:110}}),n("div",{staticClass:"tip"},[t._v("识别二维码参加问卷调查")])],1)])])]),n("a-col",{staticStyle:{height:"620px",padding:"20px",position:"relative"},attrs:{span:12}},[n("p",{staticStyle:{"font-weight":"bold",color:"#000","font-size":"16px"}},[t._v("问卷地址")]),n("div",{staticClass:"exam_url"},[n("span",[t._v(t._s(t.url))]),n("a-tag",{staticClass:"copybtn",staticStyle:{"margin-left":"10px"},attrs:{"data-clipboard-text":t.url,color:"cyan"},on:{click:t.copywxtap}},[t._v("复制地址")])],1),n("img",{staticStyle:{margin:"60px 0 0 70px"},attrs:{src:a("0263")}}),n("div",{staticClass:"btn"},[n("a-button",{attrs:{type:"primary",ghost:""},on:{click:t.exportPic}},[t._v("下载图片")])],1)])],1)],1)],1)},s=[],i=a("658f5"),r=a.n(i),o=a("c0e9"),l=a.n(o),c=a("b311"),u=a.n(c),d={components:{vueQr:r.a},data:function(){return{visible:!1,url:"",form:{}}},methods:{showModal:function(t){1!==t.state?(this.form=t,this.url=window._CONFIG["webProjectUrl"]+"/outerNet/questionnaire/"+t.id,this.visible=!0):this.$message.error("请先发布问卷！")},handleOk:function(t){this.visible=!1},exportPic:function(){l()(this.$refs.cardContent).then((function(t){var e=t.toDataURL("image/png");if(""!==e){var a=document.createElement("a");a.download="问卷名片",a.href=e,a.click()}}))},copywxtap:function(){var t=this,e=new u.a(".copybtn");e.on("success",(function(a){t.$message.success("复制成功！"),e.destroy()})),e.on("error",(function(a){t.$message.success("该浏览器不支持自动复制！"),e.destroy()}))}}},f=d,p=(a("de30"),a("0c7c")),h=Object(p["a"])(f,n,s,!1,null,"fa03c1d0",null);e["default"]=h.exports},"699d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{title:"答卷详情",width:800,footer:null},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},t._l(t.form.questionnaire_question,(function(e,n){return a("span",{key:e.key||e.id,staticClass:"content"},[1==e.question_type||2==e.question_type?a("div",{staticStyle:{"margin-bottom":"25px"}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("h3",[a("span",{class:Number(e.must_answer)?"star":""},[t._v(t._s(n+1)+"、")]),a("span",{domProps:{innerHTML:t._s(e.stem)}})])])],1),t._l(e.questionnaire_question_option,(function(n){return a("div",{key:n.sort||n.id,staticStyle:{"text-indent":"24px","margin-bottom":"10px"}},[1==e.question_type?a("span",{class:n.isChecked?"selCircular":"circular"}):t._e(),2==e.question_type?a("span",{class:n.isChecked?"selSquare":"square"}):t._e(),a("span",{domProps:{innerHTML:t._s(n.content)}}),n.is_fill&&n.isChecked&&n.answer_content?a("span",[t._v("("+t._s(n.answer_content)+")")]):t._e()])})),a("a-divider",{attrs:{dashed:""}})],2):t._e(),3==e.question_type||4==e.question_type||5==e.question_type?a("div",{staticStyle:{"margin-bottom":"25px"}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("h3",[a("span",{class:Number(e.must_answer)?"star":""},[t._v(t._s(n+1)+"、")]),a("span",{domProps:{innerHTML:t._s(e.stem)}})])])],1),3==e.question_type?a("div",{staticStyle:{"text-indent":"24px"}},[a("p",{staticStyle:{"margin-right":"15px"}},[a("span",{class:"true"==e.questionnaire_result_detailed[0].checked_num?"selCircular":"circular"}),t._v(" 正确")]),a("p",[a("span",{class:"false"==e.questionnaire_result_detailed[0].checked_num?"selCircular":"circular"}),t._v(" 错误")])]):t._e(),5==e.question_type?a("div",{staticClass:"rectangle",domProps:{innerHTML:t._s(e.questionnaire_result_detailed[0].answer_content)}}):t._e(),a("a-divider",{attrs:{dashed:""}})],1):t._e()])})),0)],1)},s=[],i=(a("159b"),a("a9e3"),a("fb6a"),a("ac1f"),a("5319"),{data:function(){return{visible:!1,form:{}}},methods:{showModal:function(t){var e=this;this.form=t,this.visible=!0,this.form.questionnaire_question.forEach((function(t){1===t.question_type||2===t.question_type?t.questionnaire_question_option.forEach((function(e){t.questionnaire_result_detailed.forEach((function(t){Number(t.checked_num)===Number(e.sort)&&(e["isChecked"]=!0,e.is_fill&&(e["answer_content"]=t.answer_content))}))})):4===t.question_type&&(t.stem=e.formatStr(t.stem,t.questionnaire_result_detailed))}))},handleOk:function(t){this.visible=!1},formatStr:function(t,e){for(var a=[],n=0;n<t.length;n++)"_"===t[n]&&a.push(n);var s=[],i=[];a.forEach((function(t,e){i.length?t-i[i.length-1]===1?(i.push(t),a.length===e+1&&s.push(i)):(s.push(i),i=[],i.push(t)):i.push(t)}));for(var r=s.length-1;r>=0;r--){var o='<div class="underline">'.concat(e[r].answer_content,"</div>");t=l(t,s[r][0],o)}function l(t,e,a){return t.slice(0,e)+a+t.slice(e)}var c=t.replace(/_/g,"");return c}}}),r=i,o=(a("af98"),a("0c7c")),l=Object(o["a"])(r,n,s,!1,null,"2bab77cf",null);e["default"]=l.exports},"705a":function(t,e,a){"use strict";a("af6f")},"8a39":function(t,e,a){},"9ab9":function(t,e,a){},af6f:function(t,e,a){},af98:function(t,e,a){"use strict";a("11bcb")},de30:function(t,e,a){"use strict";a("9ab9")}}]);