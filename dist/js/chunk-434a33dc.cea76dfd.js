(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-434a33dc","chunk-03b6eb8e"],{"032b":function(e,t,a){},"5c98":function(e,t,a){},"5e4e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"修改头像",visible:e.visible,maskClosable:!1,confirmLoading:e.confirmLoading,width:800,footer:null},on:{cancel:e.cancelHandel}},[a("a-row",[a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("vue-cropper",{ref:"cropper",attrs:{img:e.options.img,info:!0,autoCrop:e.options.autoCrop,autoCropWidth:e.options.autoCropWidth,autoCropHeight:e.options.autoCropHeight,fixedBox:e.options.fixedBox},on:{realTime:e.realTime}})],1),a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("div",{staticClass:"avatar-upload-preview"},[a("img",{style:e.previews.img,attrs:{src:e.previews.url}})])])],1),a("br"),a("a-row",[a("a-col",{attrs:{lg:2,md:2}},[a("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{icon:"upload"}},[e._v("选择图片")])],1)],1),a("a-col",{attrs:{lg:{span:1,offset:2},md:2}},[a("a-button",{attrs:{icon:"plus"},on:{click:function(t){return e.changeScale(1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"minus"},on:{click:function(t){return e.changeScale(-1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"undo"},on:{click:e.rotateLeft}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"redo"},on:{click:e.rotateRight}})],1),a("a-col",{attrs:{lg:{span:2,offset:6},md:2}},[a("a-button",{attrs:{type:"primary",loading:e.uploading},on:{click:function(t){return e.finish("blob")}}},[e._v("保存")])],1)],1)],1)},o=[],i=(a("b0c0"),a("6597")),s=a("0901"),n={data:function(){return{visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:"",autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{edit:function(e){this.visible=!0,this.id=e},close:function(){this.id=null,this.visible=!1},cancelHandel:function(){this.close()},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},beforeUpload:function(e){var t=this;this.fileList=e;var a=new FileReader;return a.readAsDataURL(e),a.onload=function(){t.options.img=a.result},!1},finish:function(e){var t=this;"blob"===e?(this.uploading=!0,this.$refs.cropper.getCropBlob((function(e){var a=new window.File([e],t.fileList.name,{type:t.fileList.type}),r=new FormData;r.append("file",a),Object(i["f"])(r).then((function(e){e.success?(t.updateAvatar(e.data),t.$emit("ok",e.data)):(t.uploading=!1,t.$message.error(e.message))}))}))):this.$refs.cropper.getCropData((function(e){}))},updateAvatar:function(e){var t=this,a={id:this.id,avatar:e};Object(s["q"])(a).then((function(e){t.uploading=!1,e.success?(t.visible=!1,t.$message.success("头像上传修改成功")):t.$message.error(e.message)}))},realTime:function(e){this.previews=e}}},c=n,l=(a("f665"),a("0c7c")),u=Object(l["a"])(c,r,o,!1,null,"db9ecb80",null);t["default"]=u.exports},d08e:function(e,t,a){"use strict";a("032b")},dd26:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"account-settings-info-view"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:24,lg:16}},[a("a-form",{attrs:{layout:"vertical",form:e.form}},[a("a-form-item",{attrs:{label:"昵称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["nickName"],expression:"['nickName']"}],attrs:{placeholder:"给自己起个昵称吧"}})],1),a("a-form-item",{attrs:{label:"生日"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["birthday",{rules:[{required:!0,message:"请选择生日！"}]}],expression:"['birthday', {rules: [{required: true, message: '请选择生日！'}]}]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择生日"},on:{change:e.onChange}})],1),a("a-form-item",{attrs:{label:"性别"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["sex",{rules:[{required:!0,message:"请选择性别！"}]}],expression:"['sex',{rules: [{ required: true, message: '请选择性别！' }]}]"}]},e._l(e.sexData,(function(t,r){return a("a-radio",{key:r,attrs:{value:parseInt(t.code)}},[e._v(e._s(t.name))])})),1)],1),a("a-form-item",{attrs:{label:"手机"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入手机号！"}]}],expression:"['phone', {rules: [{required: true, message: '请输入手机号！'}]}]"}],attrs:{placeholder:"请输入手机号"}})],1),a("a-form-item",{attrs:{label:"电话"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["tel"],expression:"['tel']"}],attrs:{placeholder:"请输入电话"}})],1),a("a-form-item",{attrs:{label:"电子邮件"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{type:"email",message:"请输入正确的邮箱号",rules:[{required:!0,message:"请输入正确的邮箱号！"}]}],expression:"['email', {type: 'email',message: '请输入正确的邮箱号',rules: [{required: true, message: '请输入正确的邮箱号！'}]}]"}],attrs:{placeholder:"请输入电子邮件地址"}})],1),a("a-form-item",[a("a-button",{attrs:{type:"primary"},on:{click:e.submitUserInfo}},[e._v("更新基本信息")])],1)],1)],1),a("a-col",{style:{minHeight:"180px"},attrs:{md:24,lg:8}},[a("div",{staticClass:"ant-upload-preview",on:{click:function(t){return e.$refs.modal.edit(e.userInfo.id)}}},[a("a-icon",{staticClass:"upload-icon",attrs:{type:"cloud-upload-o"}}),a("div",{staticClass:"mask"},[a("a-icon",{attrs:{type:"plus"}})],1),a("img",{attrs:{src:e.option.img},on:{error:function(t){return e.loadError()}}})],1)])],1),a("avatar-modal",{ref:"modal",on:{ok:e.setavatar}})],1)},o=[],i=a("f3f3"),s=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("4360")),n=a("5e4e"),c=a("2f62"),l=a("c1df"),u=a.n(l),d=a("0901"),f=a("6597"),p={components:{AvatarModal:n["default"]},data:function(){return{preview:{},form:this.$form.createForm(this),sexData:[],option:{img:"/avatar.webp",info:!0,size:1,outputType:"jpeg",canScale:!1,autoCrop:!0,autoCropWidth:180,autoCropHeight:180,fixedBox:!0,fixed:!0,fixedNumber:[1,1],birthdayString:""}}},computed:Object(i["a"])({},Object(c["c"])(["userInfo"])),mounted:function(){this.initUserInfo()},methods:{loadError:function(){var e=event.srcElement;e.src="/avatar.webp",e.onerror=null},initUserInfo:function(){var e=this;setTimeout((function(){e.form.setFieldsValue({birthday:u()(e.userInfo.birthday,"YYYY-MM-DD"),nickName:e.userInfo.nickName,sex:e.userInfo.sex,email:e.userInfo.email,phone:e.userInfo.phone,tel:e.userInfo.tel}),e.birthdayString=u()(e.userInfo.birthday).format("YYYY-MM-DD"),e.userInfo.avatar&&Object(f["d"])({id:e.userInfo.avatar}).then((function(t){e.option.img=window.URL.createObjectURL(new Blob([t]))})).catch((function(t){e.$message.error("预览错误："+t.message)})),e.getSexData()}),100)},onChange:function(e,t){this.birthdayString=t},submitUserInfo:function(){var e=this,t=this.form.validateFields;t((function(t,a){t||(a.birthday=e.birthdayString,a.id=e.userInfo.id,Object(d["r"])(a).then((function(t){t.success?(e.$message.success("个人信息更新成功"),s["a"].dispatch("GetInfo").then((function(){}))):e.$message.error(t.message)})))}))},getSexData:function(){this.sexData=this.$options.filters["dictData"]("sex")},setavatar:function(e){var t=this;Object(f["d"])({id:e}).then((function(e){t.option.img=window.URL.createObjectURL(new Blob([e]))})).catch((function(e){t.$message.error("预览错误："+e.message)})),s["a"].dispatch("GetInfo").then((function(){}))}}},m=p,h=(a("d08e"),a("0c7c")),g=Object(h["a"])(m,r,o,!1,null,"2feac0e4",null);t["default"]=g.exports},f665:function(e,t,a){"use strict";a("5c98")}}]);