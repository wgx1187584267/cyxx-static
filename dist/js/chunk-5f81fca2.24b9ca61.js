(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f81fca2","chunk-2d0e4c80"],{"12f8":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.show?n("div",{staticClass:"examTips"},[n("a-result",{staticStyle:{background:"#fff","border-radius":"15px"},attrs:{status:"success",title:"提交成功","sub-title":"— 感谢您的参与 —"}})],1):n("div",{staticStyle:{padding:"20px"}},[n("h2",{staticClass:"title"},[t._v(t._s(t.form.questionnaire_title))]),t.form.questionnaire_describe?n("p",[t._v(t._s(t.form.questionnaire_describe))]):t._e(),n("a-divider",{attrs:{dashed:""}}),t._l(t.form.questionnaire_question,(function(e,i){return n("div",{key:e.id,staticClass:"content"},[n("a-row",[n("a-col",{attrs:{span:20}},[n("p",[n("span",{class:Number(e.must_answer)?"star":"",staticStyle:{color:"#1A8CFE","font-weight":"bold"}},[t._v(t._s(i+1)+"、")]),4==e.question_type?n("span",[n("CompletionComponent",{attrs:{content:e.stem,subjectId:e.id}})],1):n("span",{domProps:{innerHTML:t._s(e.stem)}})]),1==e.question_type?n("a-radio-group",{staticStyle:{width:"100%"},on:{change:function(n){return t.onChangeSingleChoice(n,e)}}},t._l(e.questionnaire_question_option,(function(e){return n("a-radio",{key:e.id||e.key,style:t.radioStyle,attrs:{value:e.sort}},[n("span",{domProps:{innerHTML:t._s(e.content)}}),t._v(" "),e.is_fill?n("a-input",{attrs:{placeholder:"请输入内容"},model:{value:e.answer_content,callback:function(n){t.$set(e,"answer_content",n)},expression:"itemc.answer_content"}}):t._e()],1)})),1):t._e(),2==e.question_type?n("a-checkbox-group",{staticStyle:{width:"100%"},on:{change:function(n){return t.onChangeMultipleChoice(n,e)}}},t._l(e.questionnaire_question_option,(function(e){return n("a-checkbox",{key:e.id||e.key,style:t.radioStyle,attrs:{value:e.sort}},[n("span",{domProps:{innerHTML:t._s(e.content)}}),t._v(" "),e.is_fill?n("a-input",{attrs:{placeholder:"请输入内容"},model:{value:e.answer_content,callback:function(n){t.$set(e,"answer_content",n)},expression:"itemc.answer_content"}}):t._e()],1)})),1):t._e(),3==e.question_type?n("a-radio-group",{staticStyle:{display:"block","margin-top":"15px"},attrs:{"button-style":"solid"},on:{change:function(n){return t.onChangeSingleChoice(n,e)}}},[n("a-radio-button",{attrs:{value:"true"}},[t._v("正确")]),n("a-radio-button",{attrs:{value:"false"}},[t._v("错误")])],1):t._e(),5==e.question_type?n("span",[n("a-textarea",{staticStyle:{margin:"15px 0"},attrs:{placeholder:"",rows:4},model:{value:e.answer,callback:function(n){t.$set(e,"answer",n)},expression:"item.answer"}})],1):t._e()],1)],1)],1)})),n("div",[n("a-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary",block:"",size:"large"},on:{click:t.submit}},[n("a-icon",{attrs:{type:"folder-open"}}),t._v(" 提交")],1)],1)],2)])},s=[],r=(n("a9e3"),n("159b"),n("d8ad")),o=n("924e"),a=n("4a1d"),u={components:{CompletionComponent:o["default"]},data:function(){return{radioStyle:{display:"block",height:"40px",lineHeight:"40px"},form:{},submitInfor:{questionnaire_id:"",answer_time:0,questionnaire_result:[]},startTime:0,completion_result:[],show:!1}},created:function(){this.show=!1,this.submitInfor.questionnaire_id=Number(this.$route.params.id),this.getQuestionnaire(this.submitInfor.questionnaire_id)},mounted:function(){r["a"].$on("result",this.onChangeCompletionResult)},methods:{submit:function(){var t=this;if(!this.verification())return this.$message.error("有必填项未填写！"),!1;var e=parseInt(((new Date).getTime()-this.startTime)/1e3/60%60);this.submitInfor.answer_time=e,this.formatSubmitData(),Object(a["j"])(this.submitInfor).then((function(e){e.success?(t.show=!0,t.$message.success("提交成功！")):t.$message.error("提交失败："+e.message)}))},verification:function(){for(var t=!0,e=0;e<this.form.questionnaire_question.length;e++){var n=this.form.questionnaire_question[e];if(1===n.must_answer&&!n.answer&&4!==n.question_type){t=!1;break}}return t},getQuestionnaire:function(t){var e=this;Object(a["d"])({id:t}).then((function(t){t.success?(e.form=t.data,e.form.questionnaire_question.forEach((function(t){1!==t.question_type&&2!==t.question_type||t.questionnaire_question_option.forEach((function(t){t.is_fill&&(t["answer_content"]="")})),4!==t.question_type&&(t["answer"]="")})),e.startTime=(new Date).getTime()):e.$message.error("获取问卷失败："+t.message)}))},onChangeSingleChoice:function(t,e){e.answer=t.target.value},onChangeMultipleChoice:function(t,e){e.answer=t},onChangeCompletionResult:function(t){var e=this;this.completion_result.length?this.completion_result.forEach((function(n){n.id===t.id?n.questionnaire_result_detailed=t.questionnaire_result_detailed:e.completion_result.push(t)})):this.completion_result.push(t)},formatSubmitData:function(){var t=this;this.submitInfor.questionnaire_result=[],this.form.questionnaire_question.forEach((function(e){var n={id:"",questionnaire_result_detailed:[]};n.id=e.id,n.questionnaire_result_detailed=[],1===e.question_type?(e.questionnaire_question_option.forEach((function(t){t.sort===e.answer&&t.is_fill?n.questionnaire_result_detailed.push({checked_num:e.answer+"",answer_content:t.answer_content}):t.sort===e.answer&&n.questionnaire_result_detailed.push({checked_num:e.answer+"",answer_content:""})})),t.submitInfor.questionnaire_result.push(n)):2===e.question_type?e.answer.length&&(e.answer.forEach((function(t){e.questionnaire_question_option.forEach((function(e){e.sort===t&&e.is_fill?n.questionnaire_result_detailed.push({checked_num:t+"",answer_content:e.answer_content}):e.sort===t&&n.questionnaire_result_detailed.push({checked_num:t+"",answer_content:""})}))})),t.submitInfor.questionnaire_result.push(n)):3===e.question_type?(n.questionnaire_result_detailed.push({checked_num:e.answer+"",answer_content:""}),t.submitInfor.questionnaire_result.push(n)):5===e.question_type&&(n.questionnaire_result_detailed.push({checked_num:"1",answer_content:e.answer+""}),t.submitInfor.questionnaire_result.push(n))})),this.completion_result.length&&this.completion_result.forEach((function(e){t.submitInfor.questionnaire_result.push(e)}))}},beforeDestroy:function(){r["a"].$off("result")}},c=u,l=(n("1928"),n("0c7c")),d=Object(l["a"])(c,i,s,!1,null,"4528aaf3",null);e["default"]=d.exports},1928:function(t,e,n){"use strict";n("c4e7")},"4a1d":function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return r})),n.d(e,"f",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"j",(function(){return d})),n.d(e,"h",(function(){return _})),n.d(e,"g",(function(){return h}));var i=n("b775");function s(t){return Object(i["b"])({url:"/questionnaire/questionnaireAdd",method:"post",data:t})}function r(t){return Object(i["b"])({url:"/questionnaire/questionnaireEdit",method:"post",data:t})}function o(t){return Object(i["b"])({url:"/questionnaire/questionnairePage",method:"post",data:t})}function a(t){return Object(i["b"])({url:"/questionnaire/questionnaireList",method:"post",data:t})}function u(t){return Object(i["b"])({url:"/questionnaire/questionnaireDelete",method:"post",data:t})}function c(t){return Object(i["b"])({url:"/questionnaire/questionnaireState",method:"post",data:t})}function l(t){return Object(i["b"])({url:"/questionnaire/questionnaireGet",method:"post",data:t})}function d(t){return Object(i["b"])({url:"/questionnaire/questionnaireSubmit",method:"post",data:t})}function _(t){return Object(i["b"])({url:"/questionnaire/questionnaireResultPage",method:"post",data:t})}function h(t){return Object(i["b"])({url:"/questionnaire/questionnaireResultDelete",method:"post",data:t})}},"924e":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"markedContent",staticStyle:{display:"inline-block"}})},s=[],r=(n("a9e3"),n("159b"),n("ac1f"),n("5319"),n("fb6a"),n("a026")),o=n("d8ad"),a={name:"HelloWorld",props:{content:{type:String,default:""},subjectId:{type:Number,default:0}},mounted:function(){this.compile()},methods:{compile:function(){var t=this.subjectId,e=this.markdown(this.content),n=r["a"].extend({template:"<div> ".concat(e," </div>"),data:function(){return{id:t,questionnaire_result_detailed:[]}},methods:{onInputChange:function(t,e){var n=!1,i=t.target.value;this.questionnaire_result_detailed.forEach((function(t){Number(t.checked_num)===Number(e)&&(t.answer_content=i,n=!0)})),n||this.questionnaire_result_detailed.push({checked_num:e,answer_content:i});var s={id:this.id,questionnaire_result_detailed:this.questionnaire_result_detailed};o["a"].$emit("result",s)}}}),i=(new n).$mount();this.$refs["markedContent"].appendChild(i.$el)},markdown:function(t){var e=this.formatStr(t),n=0,i=e.replace(/<input type="text" /g,(function(){n++;var t='<input type="text" @change="onInputChange($event, \''.concat(n,"')\" ");return t}));return i},formatStr:function(t){for(var e=[],n=0;n<t.length;n++)"_"===t[n]&&e.push(n);var i=[],s=[];e.forEach((function(t,n){s.length?t-s[s.length-1]===1?(s.push(t),e.length===n+1&&i.push(s)):(i.push(s),s=[],s.push(t)):s.push(t)}));for(var r=i.length-1;r>=0;r--){var o='<input type="text" style="width: '.concat(10*i[r].length,'px" class="underline">');t=a(t,i[r][0],o)}function a(t,e,n){return t.slice(0,e)+n+t.slice(e)}var u=t.replace(/_/g,"");return u}}},u=a,c=n("0c7c"),l=Object(c["a"])(u,i,s,!1,null,"1dd6e7d9",null);e["default"]=l.exports},c4e7:function(t,e,n){}}]);