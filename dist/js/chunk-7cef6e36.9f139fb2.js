(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7cef6e36"],{"1cfd":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.hasPerm("sysTimers:page")?s("x-card",[s("div",{staticClass:"table-page-search-wrapper",attrs:{slot:"content"},slot:"content"},[s("a-form",{attrs:{layout:"inline"}},[s("a-row",{attrs:{gutter:48}},[s("a-col",{attrs:{md:8,sm:24}},[s("a-form-item",{attrs:{label:"任务名称"}},[s("a-input",{attrs:{"allow-clear":"",placeholder:"请输入任务名称"},model:{value:e.queryParam.timerName,callback:function(t){e.$set(e.queryParam,"timerName",t)},expression:"queryParam.timerName"}})],1)],1),s("a-col",{attrs:{md:8,sm:24}},[s("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),s("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[e._v("重置")])],1)],1)],1)],1)]):e._e(),s("a-card",{attrs:{bordered:!1}},[s("s-table",{ref:"table",attrs:{columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.id},rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"actionClass",fn:function(t){return s("span",{},[s("ellipsis",{attrs:{length:10,tooltip:""}},[e._v(e._s(t))])],1)}},{key:"remark",fn:function(t){return s("span",{},[s("ellipsis",{attrs:{length:10,tooltip:""}},[e._v(e._s(t))])],1)}},{key:"requestType",fn:function(t){return s("span",{},[e._v(" "+e._s(e.requestTypeFilter(t))+" ")])}},{key:"jobStatus",fn:function(t,a){return e.hasPerm("sysTimers:start")||e.hasPerm("sysTimers:stop")?s("span",{},[s("a-popconfirm",{attrs:{placement:"top",title:0===t?"确定停止该任务？":"确定启动该任务？"},on:{confirm:function(){return e.editjobStatusStatus(t,a)}}},[s("a-badge",{attrs:{status:0===t?"processing":"default"}}),s("a",[e._v(e._s(e.jobStatusFilter(t)))])],1)],1):s("span",{attrs:{slot:"jobStatus"},slot:"jobStatus"},[s("a-badge",{attrs:{status:0===t?"processing":"default"}}),e._v(" "+e._s(e.jobStatusFilter(t))+" ")],1)}},{key:"action",fn:function(t,a){return s("span",{},[e.hasPerm("sysTimers:edit")?s("a",{on:{click:function(t){return e.$refs.editForm.edit(a)}}},[e._v("编辑")]):e._e(),e.hasPerm("sysTimers:edit")&e.hasPerm("sysTimers:delete")?s("a-divider",{attrs:{type:"vertical"}}):e._e(),e.hasPerm("sysTimers:delete")?s("a-popconfirm",{attrs:{placement:"topRight",title:"确认删除？"},on:{confirm:function(){return e.sysTimersDelete(a)}}},[s("a",[e._v("删除")])]):e._e()],1)}}],null,!0)},[e.hasPerm("sysTimers:add")?s("template",{slot:"operator"},[e.hasPerm("sysTimers:add")?s("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:function(t){return e.$refs.addForm.add()}}},[e._v("新增定时任务 ")]):e._e()],1):e._e()],2),s("add-form",{ref:"addForm",on:{ok:e.handleOk}}),s("edit-form",{ref:"editForm",on:{ok:e.handleOk}})],1)],1)},r=[],n=(s("4de4"),s("2af9")),o=s("b89e"),i=s("40b1"),u=s("de71"),c=s("da95"),l={components:{XCard:n["w"],STable:n["r"],Ellipsis:n["h"],addForm:i["default"],editForm:u["default"]},data:function(){var e=this;return{queryParam:{},columns:[{title:"任务名称",dataIndex:"jobName"},{title:"请求地址",dataIndex:"requestUrl"},{title:"请求类型",dataIndex:"requestType",scopedSlots:{customRender:"requestType"}},{title:"请求参数",dataIndex:"requestParameters"},{title:"间隔",dataIndex:"interval"},{title:"Cron",dataIndex:"cron"},{title:"状态",dataIndex:"timerStatus",scopedSlots:{customRender:"jobStatus"}},{title:"执行次数",dataIndex:"runNumber"},{title:"备注",dataIndex:"remark",width:100}],loadData:function(t){return Object(o["e"])(Object.assign(t,e.queryParam)).then((function(e){return e.data}))},selectedRowKeys:[],selectedRows:[],requestTypeEnumDataDropDown:[]}},created:function(){this.sysEnumDataList(),(this.hasPerm("sysTimers:edit")||this.hasPerm("sysTimers:delete"))&&this.columns.push({title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}})},methods:{sysEnumDataList:function(){var e=this;Object(c["b"])({enumName:"RequestTypeEnum"}).then((function(t){e.requestTypeEnumDataDropDown=t.data}))},requestTypeFilter:function(e){var t=this.requestTypeEnumDataDropDown.filter((function(t){return t.code==e}));if(t.length>0)return t[0].value},jobStatusFilter:function(e){return 0===e?"运行中":1===e?"已停止":2===e?"执行失败":3===e?"已取消":void 0},editjobStatusStatus:function(e,t){var s=this;0===e?Object(o["g"])({id:t.id,jobName:t.jobName}).then((function(e){e.success?(s.$message.success("停止成功"),s.$refs.table.refresh()):s.$message.error("停止失败："+e.message)})):0!=e&&Object(o["f"])(t).then((function(e){e.success?(s.$message.success("启动成功"),s.$refs.table.refresh()):s.$message.error("启动失败："+e.message)}))},sysTimersDelete:function(e){var t=this;Object(o["b"])(e).then((function(e){e.success?(t.$message.success("删除成功"),t.$refs.table.refresh()):t.$message.error("删除失败："+e.message)})).catch((function(e){t.$message.error("删除错误："+e.message)}))},toggleAdvanced:function(){this.advanced=!this.advanced},handleOk:function(){this.$refs.table.refresh()},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t}},mounted:function(){}},d=l,m=(s("7bfa"),s("0c7c")),f=Object(m["a"])(d,a,r,!1,null,null,null);t["default"]=f.exports},"3a2a":function(e,t,s){},"7bfa":function(e,t,s){"use strict";s("3a2a")}}]);