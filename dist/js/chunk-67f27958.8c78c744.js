(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67f27958","chunk-f7ae52c2"],{"48d8":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-modal",{attrs:{title:e.title,width:600,bodyStyle:{padding:"10px 10px 0 10px"}},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("a-form-model",{ref:"ruleForm",attrs:{model:e.formContent,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,rules:e.rules}},[r("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"",prop:"record_content"}},[r("a-textarea",{attrs:{placeholder:"请输入回复内容",allowClear:!0,"auto-size":{minRows:10}},model:{value:e.formContent.record_content,callback:function(t){e.$set(e.formContent,"record_content",t)},expression:"formContent.record_content"}})],1)],1)],1)],1)},s=[],i=r("e377"),a={data:function(){return{visible:!1,title:"回复",labelCol:{span:0},wrapperCol:{span:24},rules:{record_content:[{required:!0,message:"请输入回复内容",trigger:"blur"}]},formData:{},formContent:{}}},methods:{reply:function(e){this.visible=!0,this.formContent=Object.assign({},this.$options.data().formContent),this.formContent=e},handleOk:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var r=JSON.parse(JSON.stringify(e.formContent));r.reply_person_type="1",r.reply_person_id=e.$userInfo.id,Object(i["a"])(r).then((function(t){t.success?(e.visible=!1,e.$message.success("回复成功！"),e.$emit("ok")):e.$message.error(JSON.stringify(t.message))}))}))}}},o=a,l=r("0c7c"),d=Object(l["a"])(o,n,s,!1,null,null,null);t["default"]=d.exports},7407:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-modal",{attrs:{title:"详细",footer:null,bodyStyle:{background:"#ECECEC"},width:800},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("a-card",{attrs:{size:"small",bordered:!1}},[r("span",{attrs:{slot:"title"},slot:"title"},[e._v("给【"+e._s(e.infor.message_recipient_name)+"】留言")]),r("a-button",{attrs:{slot:"extra",type:"primary",size:"small",shape:"round"},on:{click:function(t){return e.$refs.AddEditForm.reply({message_id:e.infor.id})}},slot:"extra"},[e._v(" 回复 ")]),r("a-descriptions",{attrs:{bordered:"",column:2,size:"small"}},[r("a-descriptions-item",{attrs:{label:"学年学期"}},[e._v(e._s(e.infor.school_year_name)+e._s(e.infor.semester_name))]),r("a-descriptions-item",{attrs:{label:"学段"}},[e._v(e._s(e.infor.academic_stage_name))]),r("a-descriptions-item",{attrs:{label:"年级/班级/学生"}},[e._v(e._s(e.infor.grade_name)+"-"+e._s(e.infor.class_name)+"-"+e._s(e.infor.student_name))]),r("a-descriptions-item",{attrs:{label:"留言时间"}},[e._v(e._s(e.infor.add_time))]),r("a-descriptions-item",{attrs:{label:"留言内容",span:2}},[e._v(e._s(e.infor.message_content))])],1)],1),r("a-card",{staticStyle:{"margin-top":"10px"},attrs:{title:"回复记录",size:"small",bordered:!1}},[e._l(e.reply,(function(t,n){return r("div",{key:n,staticClass:"bde7 radius8 mb15"},[r("div",{staticClass:"ptb10 plr10"},[r("div",{staticClass:"bold"},[e._v(" "+e._s(t.reply_person_name)+e._s("1"===t.reply_person_type?"老师":"2"===t.reply_person_type?"家长":"")+" : "+e._s(t.record_content)+" ")]),r("div",[r("span",{staticClass:"ft12 mr10"},[e._v(e._s(t.add_time))]),r("a-button",{attrs:{type:"primary",size:"small",shape:"round"},on:{click:function(r){return e.$refs.AddEditForm.reply({message_id:e.infor.id,reply_id:t.id})}}},[e._v(" 回复 ")])],1)]),t.reply_children.length?r("div",{staticClass:"bgf6 ptb15 plr30"},e._l(t.reply_children,(function(t,n){return r("div",{key:n,staticClass:"mb15"},[r("div",{staticClass:"bold"},[e._v(" "+e._s(t.reply_person_name)+e._s("1"===t.reply_person_type?"老师":"2"===t.reply_person_type?"家长":"")+" : "+e._s(t.record_content)+" ")]),r("div",[r("span",{staticClass:"ft12 mr10"},[e._v(e._s(t.add_time))]),r("a-button",{attrs:{type:"primary",size:"small",shape:"round"},on:{click:function(r){return e.$refs.AddEditForm.reply({message_id:e.infor.id,reply_id:t.id})}}},[e._v(" 回复 ")])],1)])})),0):e._e()])})),e.reply.length?e._e():r("a-empty",{attrs:{description:"暂无回复记录"}})],2),r("AddEditForm",{ref:"AddEditForm",on:{ok:function(t){return e.getDetaile()}}})],1)],1)},s=[],i=(r("159b"),r("4de4"),r("99af"),r("0481"),r("d81d"),r("e377")),a=r("48d8"),o={components:{AddEditForm:a["default"]},data:function(){return{visible:!1,id:null,infor:{id:1,school_year:1,school_year_name:"2024学年",semester:1,semester_name:"",academic_stage:"",academic_stage_name:"",grade_id:1,grade_name:"",class_id:1,class_name:"",student_id:1,student_name:"",message_content:"",add_time:"",reply_record:[{id:1,message_id:1,reply_id:null,record_content:"测试测试测试1测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",add_time:"2024年12月12日 12:12:12"},{id:1,message_id:1,reply_id:1,record_content:"测试11",add_time:"2024年12月12日 12:12:12"},{id:2,message_id:1,reply_id:1,record_content:"测试11顶顶顶顶测试11顶顶顶顶测试11顶顶顶顶测试11顶顶顶顶",add_time:"2024年12月12日 12:12:12"},{id:2,message_id:1,reply_id:null,record_content:"测试2",add_time:"2024年12月12日 12:12:13"},{id:1,message_id:1,reply_id:2,record_content:"测试11",add_time:"2024年12月12日 12:12:12"}]},reply:[]}},methods:{show:function(e){this.visible=!0,this.id=e.id,this.getDetaile()},getDetaile:function(){var e=this;Object(i["d"])({id:this.id}).then((function(t){if(t.success){var r=[],n=[];e.infor=t.data,e.infor.reply_record.forEach((function(e){e.message_id&&!e.reply_id?(e.reply_children=[],r.push(e)):n.push(e)})),r.forEach((function(t){var r=e.getDescendants(n,t.id);t.reply_children=r||[]})),e.reply=r}}))},getDescendants:function(e,t){var r=this,n=e.filter((function(e){return e.reply_id===t}));return 0===n.length?[]:n.concat(n.map((function(t){return r.getDescendants(e,t.id)})).flat())}}},l=o,d=r("0c7c"),c=Object(d["a"])(l,n,s,!1,null,null,null);t["default"]=c.exports},e377:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r("b775");function s(e){return Object(n["b"])({url:"/MessageReplyRecord/Create",method:"post",data:e})}function i(e){return Object(n["b"])({url:"/ParentMessageRecord/Get",method:"get",params:e})}function a(e){return Object(n["b"])({url:"/ParentMessageRecord/Detail",method:"get",params:e})}function o(e){return Object(n["b"])({url:"/ParentMessageRecord/Export",method:"post",data:e,responseType:"blob"})}}}]);